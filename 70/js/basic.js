if(void 0===$WH)var $WH={};$WH.$E=function(t){if(!t){if("undefined"==typeof event)return null;t=event}return t.which?t._button=t.which:(t._button=t.button,$WH.Browser.ie6789&&t._button?4&t._button?t._button=2:2&t._button&&(t._button=3):t._button=t.button+1),t._target=t.target?t.target:t.srcElement,t._wheelDelta=t.wheelDelta?t.wheelDelta:-t.detail,t},$WH.$A=function(t){for(var e=[],o=0,r=t.length;o<r;++o)e.push(t[o]);return e},Function.prototype.bind||(Function.prototype.bind=function(){var t=this,e=$WH.$A(arguments),o=e.shift();return function(){return t.apply(o,e.concat($WH.$A(arguments)))}}),$WH.bindfunc=function(){args=$WH.$A(arguments);var t=args.shift(),e=args.shift();return function(){return t.apply(e,args.concat($WH.$A(arguments)))}},String.prototype.ltrim||(String.prototype.ltrim=function(){return this.replace(/^\s*/,"")}),String.prototype.rtrim||(String.prototype.rtrim=function(){return this.replace(/\s*$/,"")}),String.prototype.trim||(String.prototype.trim=function(){return this.ltrim().rtrim()}),String.prototype.removeAllWhitespace||(String.prototype.removeAllWhitespace=function(){return this.replace("/s+/g","")}),$WH.strcmp=function(t,e){if(t==e)return 0;if(null==t)return-1;if(null==e)return 1;var o=parseFloat(t),r=parseFloat(e);return isNaN(o)||isNaN(r)||o==r?"string"==typeof t&&"string"==typeof e?t.localeCompare(e):t<e?-1:1:o<r?-1:1},$WH.stringCompare=function(t,e){if(t==e)return 0;if(null==t)return-1;if(null==e)return 1;var o=parseFloat(t),r=parseFloat(e);return isNaN(o)||isNaN(r)||o==r?"string"==typeof t&&"string"==typeof e?t.localeCompare(e):t<e?-1:1:o<r?-1:1},$WH.trim=function(t){return t.replace(/(^\s*|\s*$)/g,"")},$WH.rtrim=function(t,e){for(var o=t.length;--o>0&&t.charAt(o)==e;);return t=t.substring(0,o+1),t==e&&(t=""),t},$WH.sprintf=function(t){var e;for(e=1,len=arguments.length;e<len;++e)t=t.replace("$"+e,arguments[e]);return t},$WH.sprintfa=function(t){var e;for(e=1,len=arguments.length;e<len;++e)t=t.replace(new RegExp("\\$"+e,"g"),arguments[e]);return t},$WH.sprintfo=function(t){if("object"==typeof t&&t.length){var e=t;t=e[0];var o;for(o=1;o<e.length;++o)t=t.replace("$"+o,e[o]);return t}},$WH.str_replace=function(t,e,o){for(;-1!=t.indexOf(e);)t=t.replace(e,o);return t},$WH.urlencode=function(t){return t=encodeURIComponent(t),t=$WH.str_replace(t,"+","%2B")},$WH.urlencode2=function(t){return t=encodeURIComponent(t),t=$WH.str_replace(t,"%20","+"),t=$WH.str_replace(t,"%3D","=")},$WH.number_format=function(t){return x=(""+parseFloat(t)).split("."),t=x[0],x=x.length>1?"."+x[1]:"",t.length<=3?t+x:$WH.number_format(t.substr(0,t.length-3))+","+t.substr(t.length-3)+x},$WH.is_array=function(t){return!(!t||t.constructor!=Array)},$WH.in_array=function(t,e,o,r){if(null==t)return-1;if(o)return $WH.in_arrayf(t,e,o,r);for(var n=r||0,i=t.length;n<i;++n)if(t[n]==e)return n;return-1},$WH.in_arrayf=function(t,e,o,r){for(var n=r||0,i=t.length;n<i;++n)if(o(t[n])==e)return n;return-1},$WH.rs=function(){for(var t=$WH.rs.random,e="",o=0;o<16;o++){var r=Math.floor(Math.random()*t.length);0==o&&r<11&&(r+=10),e+=t.substring(r,r+1)}return e},$WH.rs.random="0123456789abcdefghiklmnopqrstuvwxyz",$WH.isset=function(t){return void 0!==window[t]},$WH.isset("console")||(console={log:function(){}}),$WH.array_walk=function(t,e,o){for(var r,n=0,i=t.length;n<i;++n)null!=(r=e(t[n],o,t,n))&&(t[n]=r)},$WH.array_apply=function(t,e,o){for(var r=0,n=t.length;r<n;++r)e(t[r],o,t,r)},$WH.array_filter=function(t,e){for(var o=[],r=0,n=t.length;r<n;++r)e(t[r])&&o.push(t[r]);return o},$WH.array_index=function(t,e,o,r){if(!$WH.is_array(t))return!1;if(!t.__R||r){t.__R={},o||(o=function(t){return t});for(var n=0,i=t.length;n<i;++n)t.__R[o(t[n])]=n}return null==e?t.__R:!isNaN(t.__R[e])},$WH.array_compare=function(t,e){if(t.length!=e.length)return!1;for(var o={},r=t.length;r>=0;--r)o[t[r]]=!0;for(var n=!0,r=e.length;r>=0;--r)void 0===o[e[r]]&&(n=!1);return n},$WH.array_unique=function(t){for(var e=[],o={},r=t.length-1;r>=0;--r)o[t[r]]=1;for(var r in o)e.push(r);return e},$WH.ge=function(t){return"string"!=typeof t?t:document.getElementById(t)},$WH.gE=function(t,e){return t.getElementsByTagName(e)},$WH.ce=function(t,e,o){var r=document.createElement(t);return e&&$WH.cOr(r,e),o&&$WH.ae(r,o),r},$WH.de=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)},$WH.ae=function(t,e){return $WH.is_array(e)?($WH.array_apply(e,t.appendChild.bind(t)),e):t.appendChild(e)},$WH.aef=function(t,e){return t.insertBefore(e,t.firstChild)},$WH.ee=function(t,e){for(e||(e=0);t.childNodes[e];)t.removeChild(t.childNodes[e])},$WH.ct=function(t){return document.createTextNode(t)},$WH.st=function(t,e){t.firstChild&&3==t.firstChild.nodeType?t.firstChild.nodeValue=e:$WH.aef(t,$WH.ct(e))},$WH.nw=function(t){t.style.whiteSpace="nowrap"},$WH.rf=function(){return!1},$WH.rf2=function(t){if(t=$WH.$E(t),!(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey))return!1},$WH.tb=function(){this.blur()},$WH.aE=function(t,e,o){t.addEventListener?t.addEventListener(e,o,!1):t.attachEvent&&t.attachEvent("on"+e,o)},$WH.dE=function(t,e,o){t.removeEventListener?t.removeEventListener(e,o,!1):t.detachEvent&&t.detachEvent("on"+e,o)},$WH.sp=function(t){t||(t=event),$WH.Browser.ie6789?t.cancelBubble=!0:t.stopPropagation()},$WH.sc=function(t,e,o,r,n){var i=new Date,l=t+"="+escape(o)+"; ";i.setDate(i.getDate()+e),l+="expires="+i.toUTCString()+"; ",r&&(l+="path="+r+"; "),n&&(l+="domain="+n+"; "),document.cookie=l,$WH.gc(t),$WH.gc.C[t]=o},$WH.dc=function(t){$WH.sc(t,-1),$WH.gc.C[t]=null},$WH.gc=function(t){if(null==$WH.gc.I){var e=unescape(document.cookie).split("; ");$WH.gc.C={};for(var o=0,r=e.length;o<r;++o){var n,i,l=e[o].indexOf("=");-1!=l?(n=e[o].substr(0,l),i=e[o].substr(l+1)):(n=e[o],i=""),$WH.gc.C[n]=i}$WH.gc.I=1}return t?$WH.gc.C[t]:$WH.gc.C},$WH.ns=function(t){$WH.Browser.ie6789&&(t.onfocus=$WH.tb,t.onmousedown=t.onselectstart=t.ondragstart=$WH.rf)},$WH.eO=function(t){for(var e in t)delete t[e]},$WH.dO=function(t){function e(){}return e.prototype=t,new e},$WH.cO=function(t,e){for(var o in e)null!==e[o]&&"object"==typeof e[o]&&e[o].length?t[o]=e[o].slice(0):t[o]=e[o];return t},$WH.cOr=function(t,e){for(var o in e)"object"==typeof e[o]?e[o].length?t[o]=e[o].slice(0):(t[o]||(t[o]={}),$WH.cOr(t[o],e[o])):t[o]=e[o];return t},$WH.Browser={ie:!(!window.attachEvent||window.opera),opera:!!window.opera,safari:-1!=navigator.userAgent.indexOf("Safari"),firefox:-1!=navigator.userAgent.indexOf("Firefox"),chrome:-1!=navigator.userAgent.indexOf("Chrome")},$WH.Browser.ie9=$WH.Browser.ie&&-1!=navigator.userAgent.indexOf("MSIE 9.0"),$WH.Browser.ie8=$WH.Browser.ie&&-1!=navigator.userAgent.indexOf("MSIE 8.0")&&!$WH.Browser.ie9,$WH.Browser.ie7=$WH.Browser.ie&&-1!=navigator.userAgent.indexOf("MSIE 7.0")&&!$WH.Browser.ie8,$WH.Browser.ie6=$WH.Browser.ie&&-1!=navigator.userAgent.indexOf("MSIE 6.0")&&!$WH.Browser.ie7,$WH.Browser.ie67=$WH.Browser.ie6||$WH.Browser.ie7,$WH.Browser.ie678=$WH.Browser.ie67||$WH.Browser.ie8,$WH.Browser.ie6789=$WH.Browser.ie678||$WH.Browser.ie9,navigator.userAgent.match(/Gecko\/([0-9]+)/),$WH.Browser.geckoVersion=0|parseInt(RegExp.$1),$WH.OS={windows:-1!=navigator.appVersion.indexOf("Windows"),mac:-1!=navigator.appVersion.indexOf("Macintosh"),linux:-1!=navigator.appVersion.indexOf("Linux")},$WH.localStorage=new function(){this.isSupported=function(){var t;try{t="localStorage"in window&&null!==window.localStorage}catch(e){t=!1}if(t)try{localStorage.setItem("test","123"),t="123"==localStorage.getItem("test"),localStorage.removeItem("test")}catch(e){t=!1}return $WH.localStorage.isSupported=function(t){return t}.bind(null,t),t},this.set=function(t,e){$WH.localStorage.isSupported()&&localStorage.setItem(t,e)},this.get=function(t){if($WH.localStorage.isSupported())return localStorage.getItem(t)},this.remove=function(t){$WH.localStorage.isSupported()&&localStorage.removeItem(t)}},$WH.g_getWindowSize=function(){var t=0,e=0;return document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(t=document.documentElement.clientWidth,e=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)?(t=document.body.clientWidth,e=document.body.clientHeight):"number"==typeof window.innerWidth&&(t=window.innerWidth,e=window.innerHeight),{w:t,h:e}},$WH.g_getScroll=function(){var t=0,e=0;return"number"==typeof window.pageYOffset?(t=window.pageXOffset,e=window.pageYOffset):document.body&&(document.body.scrollLeft||document.body.scrollTop)?(t=document.body.scrollLeft,e=document.body.scrollTop):document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(t=document.documentElement.scrollLeft,e=document.documentElement.scrollTop),{x:t,y:e}},$WH.g_getCursorPos=function(t){var e,o;if(window.innerHeight)t.pageX&&t.pageY?(e=t.pageX,o=t.pageY):(e=t.clientX,o=t.clientY);else{var r=$WH.g_getScroll();e=t.clientX+r.x,o=t.clientY+r.y}return{x:e,y:o}},$WH.ac=function(t,e){for(var o,r=0,n=0;t;){for(r+=t.offsetLeft,n+=t.offsetTop,o=t.parentNode;o&&o!=t.offsetParent&&o.offsetParent;){if(o.scrollLeft||o.scrollTop){r-=0|o.scrollLeft,n-=0|o.scrollTop;break}o=o.parentNode}t=t.offsetParent}if($WH.isset("Lightbox")&&Lightbox.isVisible()&&(e=!0),e){var i=$WH.g_getScroll();r+=i.x,n+=i.y}var l=[r,n];return l.x=r,l.y=n,l},$WH.g_scrollTo=function(t,e){var o,r=$WH.g_getWindowSize(),n=$WH.g_getScroll(),i=r.w,l=r.h,a=n.x,s=n.y;t=$WH.ge(t),null==e?e=[]:"number"==typeof e&&(e=[e]),o=e.length,0==o?e[0]=e[1]=e[2]=e[3]=0:1==o?e[1]=e[2]=e[3]=e[0]:2==o?(e[2]=e[0],e[3]=e[1]):3==o&&(e[3]=e[1]),o=$WH.ac(t);var p=o[0]-e[3],c=o[1]-e[0],u=o[0]+t.offsetWidth+e[1],f=o[1]+t.offsetHeight+e[2];u-p>i||p<a?a=p:u-i>a&&(a=u-i),f-c>l||c<s?s=c:f-l>s&&(s=f-l),scrollTo(a,s)},$WH.g_createReverseLookupJson=function(t){var e={};for(var o in t)e[t[o]]=o;return e},$WH.g_getLocaleFromDomain=function(t){var e=$WH.g_getLocaleFromDomain.L;if(t){var o=t.indexOf(".");-1!=o&&(t=t.substring(0,o))}return e[t]?e[t]:0},$WH.g_getLocaleFromDomain.L={fr:2,de:3,cn:4,es:6,ru:8,www:0},$WH.g_getDomainFromLocale=function(t){var e;return e=$WH.g_getDomainFromLocale.L?$WH.g_getDomainFromLocale.L:$WH.g_getDomainFromLocale.L=$WH.g_createReverseLookupJson($WH.g_getLocaleFromDomain.L),e[t]?e[t]:"www"},$WH.g_getIdFromTypeName=function(t){var e=$WH.g_getIdFromTypeName.L;return e[t]?e[t]:-1},$WH.g_getIdFromTypeName.L={npc:1,object:2,item:3,itemset:4,quest:5,spell:6,zone:7,faction:8,pet:9,achievement:10,title:11,event:12,class:13,race:14,skill:15,currency:17,profile:100},$WH.g_ajaxIshRequest=function(t){var e=document.getElementsByTagName("head")[0],o=$WH.g_getGets();null!=o.refresh&&(o.refresh.length?t+="&refresh="+o.refresh:t+="&refresh"),null!=o.locale&&(t+="&locale="+o.locale),$WH.ae(e,$WH.ce("script",{type:"text/javascript",src:t,charset:"utf8"}))},$WH.g_getGets=function(){if(null!=$WH.g_getGets.C)return $WH.g_getGets.C;var t=$WH.g_getQueryString(),e=$WH.g_parseQueryString(t);return $WH.g_getGets.C=e,e},$WH.g_getQueryString=function(){var t="";return location.pathname&&(t+=location.pathname.substr(1)),location.search&&(location.pathname&&(t+="&"),t+=location.search.substr(1)),t},$WH.g_parseQueryString=function(t){t=decodeURIComponent(t);for(var e=t.split("&"),o={},r=0,n=e.length;r<n;++r)$WH.g_splitQueryParam(e[r],o);return o},$WH.g_splitQueryParam=function(t,e){var o,r,n=t.indexOf("=");-1!=n?(o=t.substr(0,n),r=t.substr(n+1)):(o=t,r=""),e[o]=r},$WH.g_createRect=function(t,e,o,r){return{l:t,t:e,r:t+o,b:e+r}},$WH.g_intersectRect=function(t,e){return!(t.l>=e.r||e.l>=t.r||t.t>=e.b||e.t>=t.b)},$WH.g_setRatingLevel=function(t,e,o,r){var n=prompt($WH.sprintf(LANG.prompt_ratinglevel,1,80),e);if(null!=n&&(n|=0)!=e&&n>=1&&n<=80){e=n;var i=$WH.g_convertRatingToPercent(e,o,r);i=Math.round(100*i)/100,12!=o&&37!=o&&(i+="%"),t.innerHTML=$WH.sprintf(LANG.tooltip_combatrating,i,e),t.onclick=$WH.g_setRatingLevel.bind(0,t,e,o,r)}},$WH.g_convertRatingToPercent=function(t,e,o,r){var n=$WH.g_convertRatingToPercent.RB;t<0?t=1:t>80&&(t=80),(14==e||12==e||15==e)&&t<34&&(t=34),28!=e&&36!=e||2!=r&&6!=r&&7!=r&&11!=r||(n[e]/=1.3),o<0&&(o=0);var i;if(n&&null!=n[e]){var l;l=t>70?82/52*Math.pow(131/63,(t-70)/10):t>60?82/(262-3*t):t>10?(t-8)/52:2/52,i=o/n[e]/l}else i=0;return i},$WH.g_statToJson={1:"health",2:"mana",3:"agi",4:"str",5:"int",6:"spi",7:"sta",8:"energy",9:"rage",10:"focus",12:"defrtng",13:"dodgertng",14:"parryrtng",15:"blockrtng",16:"mlehitrtng",17:"rgdhitrtng",18:"splhitrtng",19:"mlecritstrkrtng",20:"rgdcritstrkrtng",21:"splcritstrkrtng",22:"_mlehitrtng",23:"_rgdhitrtng",24:"_splhitrtng",25:"_mlecritstrkrtng",26:"_rgdcritstrkrtng",27:"_splcritstrkrtng",28:"mlehastertng",29:"rgdhastertng",30:"splhastertng",31:"hitrtng",32:"critstrkrtng",33:"_hitrtng",34:"_critstrkrtng",35:"resirtng",36:"hastertng",37:"exprtng",38:"atkpwr",39:"rgdatkpwr",40:"feratkpwr",41:"splheal",42:"spldmg",43:"manargn",44:"armorpenrtng",45:"splpwr",46:"healthrgn",47:"splpen",48:"block",49:"mastrtng",50:"armor",51:"firres",52:"frores",53:"holres",54:"shares",55:"natres",56:"arcres",57:"firsplpwr",58:"frosplpwr",59:"holsplpwr",60:"shasplpwr",61:"natsplpwr",62:"arcsplpwr"},$WH.g_jsonToStat={};for(var i in $WH.g_statToJson)$WH.g_jsonToStat[$WH.g_statToJson[i]]=i;$WH.g_individualToGlobalStat={16:31,17:31,18:31,19:32,20:32,21:32,22:33,23:33,24:33,25:34,26:34,27:34,28:36,29:36,30:36},$WH.g_convertScalingFactor=function(t,e,o,r,n){var i=$WH.g_convertScalingFactor.SV,l=$WH.g_convertScalingFactor.SD;if(!i[t])return g_user.roles&U_GROUP_ADMIN&&alert("There are no item scaling values for level "+t),n?{}:0;var a={},s=i[t],p=l[o];return p&&r>=0&&r<=9?(a.n=$WH.g_statToJson[p[r]],a.s=p[r],a.v=Math.floor(s[e]*p[r+10]/1e4)):a.v=s[e],n?a:a.v},$WH.wowheadRemote||$WH.g_ajaxIshRequest("?data=item-scaling"),$WH.g_getDataSource=function(){if($WH.isset("g_pageInfo"))switch(g_pageInfo.type){case 3:if($WH.isset("g_items"))return g_items;case 6:if($WH.isset("g_spells"))return g_spells}return[]},$WH.g_setJsonItemLevel=function(t,e){if(t.scadist&&t.scaflags){t.bonuses=t.bonuses||{};for(var o=-1,r=-1,i=-1,l=-1,a=0;a<24;++a){var s=1<<a;s&t.scaflags&&(262175&s&&o<0?o=a:16253408&s&&r<0?r=a:32256&s&&i<0?i=a:32768&s&&l<0&&(l=a))}if(o>=0)for(var a=0;a<10;++a){var p=$WH.g_convertScalingFactor(e,o,t.scadist,a,1);p.n&&(t[p.n]=p.v),t.bonuses[p.s]=p.v}if(r>=0&&(t.armor=$WH.g_convertScalingFactor(e,r)),i>=0){var c=5120&t.scaflags?.2:.3,u=5120&t.scaflags?"mle":"rgd";t.dps=t[u+"dps"]=$WH.g_convertScalingFactor(e,i),t.dmgmin=t[u+"dmgmin"]=Math.floor(t.dps*t.speed*(1-c)),t.dmgmax=t[u+"dmgmax"]=Math.floor(t.dps*t.speed*(1+c)),t.feratkpwr&&(t.feratkpwr=Math.max(0,Math.floor(14*(t.dps-54.8))))}if(l>=0&&(t.splpwr=t.bonuses[45]=$WH.g_convertScalingFactor(e,l)),null!=t.gearscore){null==t._gearscore&&(t._gearscore=t.gearscore);var f=Math.min(80,e+1);n=f>=70?9.5*(f-70)+105:f>=60?4.5*(f-60)+60:f+5,t.gearscore=t._gearscore*n/1.8}}},$WH.g_setTooltipLevel=function(t,e){var o=typeof t;if("number"==o){var r=$WH.g_getDataSource();if(!r[t]||!r[t][(buff?"buff_":"tooltip_")+Locale.getName()])return t;t=r[t][(buff?"buff_":"tooltip_")+Locale.getName()]}else if("string"!=o)return t;if(!(o=t.match(/<!--\?([0-9:]*)-->/)))return t;o=o[1].split(":");var e=Math.min(parseInt(o[2]),Math.max(parseInt(o[1]),e)),n=parseInt(o[4])||0;if(n&&!t.match(/<!--pts[0-9](:[0-9])?-->/g)){var i=parseInt(o[5])||0,l=t.match(/<!--spd-->(\d\.\d+)/);l&&(l=parseFloat(l[1])||0);var a={scadist:n,scaflags:i,speed:l};$WH.g_setJsonItemLevel(a,e),t=t.replace(/(<!--asc(\d+)-->)([^<]+)/,function(t,r,n){return o=n,e<40&&(3==n||4==n)&&--o,$WH.isset("g_itemset_types")?r+g_itemset_types[o]:t}),t=t.replace(/(<!--dmg-->)\d+(\D+)\d+/,function(t,e,o){return e+a.dmgmin+o+a.dmgmax}),t=t.replace(/(<!--dps-->\D*?)(\d+\.\d)/,function(t,e){return e+a.dps.toFixed(1)}),t=t.replace(/<span class="c11"><!--fap-->(\D*?)(\d+)(\D*?)<\/span>(<br \/>)?/i,function(t,e,o,r,n){var i;return o=Math.floor(14*(a.dps-54.8)),a.dps>54.8&&o>0?(i="",n=n?"<br />":""):(o=0,i=' style="display: none"',n=n?"\x3c!--br--\x3e":""),'<span class="c11"'+i+">\x3c!--fap--\x3e"+e+o+r+"</span>"+n}),t=t.replace(/(<!--amr-->)\d+/,function(t,e){return e+a.armor}),t=t.replace(/<span><!--stat(\d+)-->[-+]\d+(\D*?)<\/span>(<!--e-->)?(<!--ps-->)?(<br ?\/?>)?/gi,function(t,e,o,r,n,i){var l,s=a.bonuses[e];return s?(s=(s>0?"+":"-")+s,l="",i=i?"<br />":""):(s="+0",l=' style="display: none"',i=i?"\x3c!--br--\x3e":""),"<span"+l+">\x3c!--stat"+e+"--\x3e"+s+o+"</span>"+(r||"")+(n||"")+i}),t=t.replace(/<span class="q2">(.*?)<!--rtg(\d+)-->\d+(.*?)<\/span>(<br \/>)?/gi,function(t,e,o,r,n,i,l){var s,p=a.bonuses[$WH.g_individualToGlobalStat[o]||o];return p?(s="",l=l?"<br />":""):(s=' style="display: none"',l=l?"\x3c!--br--\x3e":""),'<span class="q2"'+s+">"+e+"\x3c!--rtg"+o+"--\x3e"+p+r+"</span>"+l})}return t=t.replace(/<!--ppl(\d+):(\d+):(\d+):(\d+)-->\s*\d+/gi,function(t,o,r,n,i){return"\x3c!--ppl"+o+":"+r+":"+n+":"+i+"--\x3e"+Math.round(parseInt(n)+(Math.min(Math.max(e,o),r)-o)*i/100)}),nMatch=[],t=t.replace(/(<!--rtg%(\d+)-->)([\.0-9]+)/g,function(r,n,i,l){return nMatch[i]||(nMatch[i]=0),o=t.match(new RegExp("\x3c!--rtg"+i+"--\x3e(\\d+)","g"))[nMatch[i]++],o?n+Math.round(100*$WH.g_convertRatingToPercent(e,i,o.split(">")[1]))/100:r}),t=t.replace(/(<!--\?\d+:\d+:\d+:)\d+((:\d+:\d+)?-->)/,"$1"+e+"$2"),t=t.replace(/<!--lvl-->\d+/g,"\x3c!--lvl--\x3e"+e)},$WH.g_setTooltipSpells=function(t,e,o,r){var n,i={},l="\x3c!--sp([0-9]+):[01]--\x3e.*?\x3c!--sp\\1--\x3e";null==e&&(e=[]),null==r&&(r={});for(var a=0;a<e.length;++a)i[e[a]]=1;if(n=t.match(new RegExp(l,"g")))for(var a=0;a<n.length;++a){var s=n[a].match(l)[1];if(i[s]=0|i[s],null==r[s]&&(r[s]=-1),r[s]++,null!=o[s]&&null!=o[s][r[s]]&&null!=o[s][r[s]][i[s]]){var p=o[s][r[s]][i[s]];p=$WH.g_setTooltipSpells(p.toString(),e,o,r),t=t.replace(n[a],"\x3c!--sp"+s+":"+i[s]+"--\x3e"+p+"\x3c!--sp"+s+"--\x3e")}}return t},$WH.g_enhanceTooltip=function(t,e,o,r,n,i,l){var a,s=typeof t;if("number"==s){var p=$WH.g_getDataSource(),c=t;if(!p[c]||!p[c][(n?"buff_":"tooltip_")+Locale.getName()])return t;t=p[c][(n?"buff_":"tooltip_")+Locale.getName()],(a=p[c][(n?"buff":"")+"spells_"+Locale.getName()])&&(t=$WH.g_setTooltipSpells(t,i,a))}else if("string"!=s)return t;if(o){var u=$WH.g_getGets();u.lvl&&(t=$WH.g_setTooltipLevel(t,u.lvl,n))}if(e&&(t=t.replace(/<span class="q2"><!--addamr(\d+)--><span>.*?<\/span><\/span>/i,function(t,e){return'<span class="q2 tip" onmouseover="$WH.Tooltip.showAtCursor(event, $WH.sprintf(LANG.tooltip_armorbonus, '+e+'), 0, 0, \'q\')" onmousemove="$WH.Tooltip.cursorUpdate(event)" onmouseout="$WH.Tooltip.hide()">'+t+"</span>"}),t=t.replace(/\(([^\)]*?<!--lvl-->[^\(]*?)\)/gi,function(t,e){return'(<a href="javascript:;" onmousedown="return false" class="tip" style="color: white; cursor: pointer" onclick="$WH.g_staticTooltipLevelClick(this, null, 0)" onmouseover="$WH.Tooltip.showAtCursor(event, \'<span class=\\\'q2\\\'>\' + LANG.tooltip_changelevel + \'</span>\')" onmousemove="$WH.Tooltip.cursorUpdate(event)" onmouseout="$WH.Tooltip.hide()">'+e+"</a>)"})),r&&Slider)if(n&&n.slider)n.bufftip=this;else{var s=t.match(/<!--\?(\d+):(\d+):(\d+):(\d+)/);s&&s[2]!=s[3]&&(this.slider=Slider.init(r,{minValue:parseInt(s[2]),maxValue:parseInt(s[3]),onMove:$WH.g_tooltipSliderMove.bind(this)}),Slider.setValue(this.slider,parseInt(s[4])),this.slider.onmousemove=$WH.Tooltip.cursorUpdate,this.slider.onmouseout=$WH.Tooltip.hide,this.slider.onmouseover=function(t){$WH.Tooltip.showAtCursor(t,LANG.tooltip_changelevel2,0,0,"q2")})}if(l){if(n&&n.modified)n.bufftip=this;else for(var f in a)g_spells[f]&&-1==$WH.in_array(i,f)&&($(l).append('<input type="checkbox" id="known-'+f+'" />').append('<label for="known-'+f+'"><a rel="spell='+f+"&know="+f+"&domain="+Locale.current.domain+'">'+g_spells[f]["name_"+Locale.getName()]+(g_spells[f]["rank_"+Locale.getName()]?" ("+g_spells[f]["rank_"+Locale.getName()]+")":"")+"</a></label>").append("<br />"),$("#known-"+f).change($WH.g_tooltipSpellsChange.bind(this)));this.modified=[l,a,i],$(l).toggle(!$(l).is(":empty"))}return t},$WH.g_staticTooltipLevelClick=function(t,e,o,r){for(;-1==t.className.indexOf("tooltip");)t=t.parentNode;var n=t.innerHTML;if(n=n.match(/<!--\?(\d+):(\d+):(\d+):(\d+)/)){var i=parseInt(n[1]),l=parseInt(n[2]),a=parseInt(n[3]),s=parseInt(n[4]);if(!(l>=a||(e||(e=prompt($WH.sprintf(LANG.prompt_ratinglevel,l,a),s)),e=parseInt(e),isNaN(e)||e==s||e<l||e>a))){var p=$WH.g_getDataSource();n=$WH.g_setTooltipLevel(p[i][(r?"buff_":"tooltip_")+Locale.getName()],e,r),n=$WH.g_enhanceTooltip(n,!0),t.innerHTML="<table><tr><td>"+n+'</td><th style="background-position: top right"></th></tr><tr><th style="background-position: bottom left"></th><th style="background-position: bottom right"></th></tr></table>',$WH.Tooltip.fixSafe(t,1,1),t.slider&&!o&&Slider.setValue(t.slider,e),r||$WH.g_tooltipSpellsChange.bind(t)()}}},$WH.g_tooltipSliderMove=function(t,e,o){$WH.g_staticTooltipLevelClick(this,o.value,1),this.bufftip&&$WH.g_staticTooltipLevelClick(this.bufftip,o.value,1,1),$WH.Tooltip.hide()},$WH.g_tooltipSpellsChange=function(){if(this.modified){var t=this.modified[0],e=this.modified[1],o=[];$.each($("input:checked",t),function(t,e){o.push(parseInt(e.id.replace("known-","")))}),this.modified[2]=o,this.innerHTML=$WH.g_setTooltipSpells(this.innerHTML,o,e),this.bufftip&&$WH.g_tooltipSpellsChange.bind(this.bufftip)()}},$WH.Tooltip={create:function(t,e){var o=$WH.ce("div"),r=$WH.ce("table"),n=$WH.ce("tbody"),i=$WH.ce("tr"),l=$WH.ce("tr"),a=$WH.ce("td"),s=$WH.ce("th"),p=$WH.ce("th"),c=$WH.ce("th");if(o.className="wowhead-tooltip",s.style.backgroundPosition="top right",p.style.backgroundPosition="bottom left",c.style.backgroundPosition="bottom right",t&&(a.innerHTML=t),$WH.ae(i,a),$WH.ae(i,s),$WH.ae(n,i),$WH.ae(l,p),$WH.ae(l,c),$WH.ae(n,l),$WH.ae(r,n),e||($WH.Tooltip.icon=$WH.ce("p"),$WH.Tooltip.icon.style.visibility="hidden",$WH.ae($WH.Tooltip.icon,$WH.ce("div")),$WH.ae(o,$WH.Tooltip.icon)),$WH.ae(o,r),!e){var u=$WH.ce("div");u.className="tooltip-powered",$WH.ae(o,u),$WH.Tooltip.logo=u}return o},getMultiPartHtml:function(t,e){return"<table><tr><td>"+t+"</td></tr></table><table><tr><td>"+e+"</td></tr></table>"},fix:function(t,e,o){var r=$WH.gE(t,"table")[0],n=$WH.gE(r,"td")[0],i=n.childNodes;if(t.className=$WH.trim(t.className.replace("tooltip-slider","")),i.length>=2&&"TABLE"==i[0].nodeName&&"TABLE"==i[1].nodeName){i[0].style.whiteSpace="nowrap";var l=parseInt(t.style.width);t.slider&&l||(l=i[1].offsetWidth>300?Math.max(300,i[0].offsetWidth)+20:Math.max(i[0].offsetWidth,i[1].offsetWidth)+20),l=Math.min(320,l),l>20&&(t.style.width=l+"px",i[0].style.width=i[1].style.width="100%",t.slider&&(Slider.setSize(t.slider,l-6),t.className+=" tooltip-slider"),!e&&t.offsetHeight>document.body.clientHeight&&(r.className="shrink"))}o&&(t.style.visibility="visible")},fixSafe:function(t,e,o){$WH.Tooltip.fix(t,e,o)},append:function(t,e){var t=$WH.ge(t),o=$WH.Tooltip.create(e);$WH.ae(t,o),$WH.Tooltip.fixSafe(o,1,1)},prepare:function(){if(!$WH.Tooltip.tooltip){var t=$WH.Tooltip.create();t.style.position="absolute",t.style.left=t.style.top="-2323px",$WH.ae(document.body,t),$WH.Tooltip.tooltip=t,$WH.Tooltip.tooltipTable=$WH.gE(t,"table")[0],$WH.Tooltip.tooltipTd=$WH.gE(t,"td")[0];var t=$WH.Tooltip.create(null,!0);t.style.position="absolute",t.style.left=t.style.top="-2323px",$WH.ae(document.body,t),$WH.Tooltip.tooltip2=t,$WH.Tooltip.tooltipTable2=$WH.gE(t,"table")[0],$WH.Tooltip.tooltipTd2=$WH.gE(t,"td")[0]}},set:function(t,e){var o=$WH.Tooltip.tooltip;if(o.style.width="550px",o.style.left="-2323px",o.style.top="-2323px",t.nodeName?($WH.ee($WH.Tooltip.tooltipTd),$WH.ae($WH.Tooltip.tooltipTd,t)):$WH.Tooltip.tooltipTd.innerHTML=t,o.style.display="",$WH.Tooltip.fix(o,0,0),e){$WH.Tooltip.showSecondary=!0;var o=$WH.Tooltip.tooltip2;o.style.width="550px",o.style.left="-2323px",o.style.top="-2323px",e.nodeName?($WH.ee($WH.Tooltip.tooltipTd2),$WH.ae($WH.Tooltip.tooltipTd2,e)):$WH.Tooltip.tooltipTd2.innerHTML=e,o.style.display="",$WH.Tooltip.fix(o,0,0)}else $WH.Tooltip.showSecondary=!1},moveTests:[[null,null],[null,!1],[!1,null],[!1,!1]],move:function(t,e,o,r,n,i){if($WH.Tooltip.tooltipTable){var l,a=$WH.Tooltip.tooltip,s=$WH.Tooltip.tooltipTable.offsetWidth,p=($WH.Tooltip.tooltipTable.offsetHeight,$WH.Tooltip.tooltip2),c=$WH.Tooltip.showSecondary?$WH.Tooltip.tooltipTable2.offsetWidth:0;$WH.Tooltip.showSecondary&&$WH.Tooltip.tooltipTable2.offsetHeight;a.style.width=s+"px",p.style.width=c+"px";for(var u,f=0,g=$WH.Tooltip.moveTests.length;f<g;++f){l=$WH.Tooltip.moveTests[f],u=$WH.Tooltip.moveTest(t,e,o,r,n,i,l[0],l[1]);break}a.style.left=u.l+"px",a.style.top=u.t+"px",a.style.visibility="visible",$WH.Tooltip.showSecondary&&(p.style.left=u.l+s+"px",p.style.top=u.t+"px",p.style.visibility="visible")}},moveTest:function(t,e,o,r,n,i,l,a){var s=t,p=e,c=($WH.Tooltip.tooltip,$WH.Tooltip.tooltipTable.offsetWidth),u=$WH.Tooltip.tooltipTable.offsetHeight,f=($WH.Tooltip.tooltip2,$WH.Tooltip.showSecondary?$WH.Tooltip.tooltipTable2.offsetWidth:0),g=$WH.Tooltip.showSecondary?$WH.Tooltip.tooltipTable2.offsetHeight:0,d=$WH.g_getWindowSize(),$=$WH.g_getScroll(),W=d.w,H=d.h,h=$.x,m=$.y,v=h,_=m,T=h+W,y=m+H;return null==l&&(l=t+o+c+f<=T),null==a&&(a=e-Math.max(u,g)>=_),l?t+=o+n:t=Math.max(t-(c+f),v)-n,a?e-=Math.max(u,g)+i:e+=r+i,t<v?t=v:t+c+f>T&&(t=T-(c+f)),e<_?e=_:e+Math.max(u,g)>y&&(e=Math.max(m,y-Math.max(u,g))),$WH.Tooltip.iconVisible&&s>=t-48&&s<=t&&p>=e-4&&p<=e+48&&(e-=48-(p-e)),$WH.g_createRect(t,e,c,u)},show:function(t,e,o,r,n,i){if(!$WH.Tooltip.disabled){(!o||o<1)&&(o=1),(!r||r<1)&&(r=1),n&&(e='<span class="'+n+'">'+e+"</span>");var l=$WH.ac(t);$WH.Tooltip.prepare(),$WH.Tooltip.set(e,i),$WH.Tooltip.move(l.x,l.y,t.offsetWidth,t.offsetHeight,o,r)}},showAtCursor:function(t,e,o,r,n,i){if(!$WH.Tooltip.disabled){(!o||o<10)&&(o=10),(!r||r<10)&&(r=10),n&&(e='<span class="'+n+'">'+e+"</span>",i&&(i='<span class="'+n+'">'+i+"</span>")),t=$WH.$E(t);var l=$WH.g_getCursorPos(t);$WH.Tooltip.prepare(),$WH.Tooltip.set(e,i),$WH.Tooltip.move(l.x,l.y,0,0,o,r)}},showAtXY:function(t,e,o,r,n,i){$WH.Tooltip.disabled||($WH.Tooltip.prepare(),$WH.Tooltip.set(t,i),$WH.Tooltip.move(e,o,0,0,r,n))},cursorUpdate:function(t,e,o){if(!$WH.Tooltip.disabled&&$WH.Tooltip.tooltip){t=$WH.$E(t),(!e||e<10)&&(e=10),(!o||o<10)&&(o=10);var r=$WH.g_getCursorPos(t);$WH.Tooltip.move(r.x,r.y,0,0,e,o)}},hide:function(){$WH.Tooltip.tooltip&&($WH.Tooltip.tooltip.style.display="none",$WH.Tooltip.tooltip.visibility="hidden",$WH.Tooltip.tooltipTable.className="",$WH.Tooltip.setIcon(null)),$WH.Tooltip.tooltip2&&($WH.Tooltip.tooltip2.style.display="none",$WH.Tooltip.tooltip2.visibility="hidden",$WH.Tooltip.tooltipTable2.className="")},setIcon:function(t){$WH.Tooltip.prepare(),t?($WH.Tooltip.icon.style.backgroundImage="url("+g_staticDataUrl+"/images/wow/icons/medium/"+t.toLowerCase()+".jpg)",$WH.Tooltip.icon.style.visibility="visible"):($WH.Tooltip.icon.style.backgroundImage="none",$WH.Tooltip.icon.style.visibility="hidden"),$WH.Tooltip.iconVisible=t?1:0},simple:function(t,e,o,r){r?t.onmouseover=function(r){$WH.Tooltip.show(t,e,!1,!1,o)}:(t.onmouseover=function(t){$WH.Tooltip.showAtCursor(t,e,!1,!1,o)},t.onmousemove=$WH.Tooltip.cursorUpdate),t.onmouseout=$WH.Tooltip.hide}},$WH.g_createButton=function(t,e,o){var r=[],n=[],i=null;o||(o={}),o["no-margin"]||n.push("margin-left:5px"),"string"==typeof e&&""!==e||(e="javascript:;"),"string"==typeof o.class&&r.push(o.class),o.disabled&&(e="javascript:;"),void 0===o.float||o.float||n.push("float:right"),"string"==typeof o.style&&n.push(o.style),"function"!=typeof o.click||o.disabled||(i=o.click);var l=RedButton.create(t||"\0",!o.disabled,i);return n.length&&$(l).attr("style",n.join(";")),r.length&&$(l).addClass(r.join(" ")),l.href=e,o["new-window"]&&(l.target="_blank"),"string"==typeof o.id&&(l.id=o.id),void 0!==o.tooltip&&(!1===o.tooltip?l.rel="np":"string"==typeof o.tooltip?$WH.Tooltip.simple(l,o.tooltip,null,!0):"object"==typeof o.tooltip&&o.tooltip.text&&$WH.Tooltip.simple(l,o.tooltip.text,o.tooltip.class,!0)),l},$WH.isset("$WowheadPower")&&$WowheadPower.init(),$WH.g_getProfileIcon=function(t,e,o,r,n,i){var l={10:{6:1,3:1,8:1,2:1,5:1,4:1,9:1},11:{6:1,3:1,8:1,2:1,5:1,7:1,1:1},3:{6:1,3:1,2:1,5:1,4:1,1:1},7:{6:1,8:1,4:1,9:1,1:1},1:{6:1,8:1,2:1,5:1,4:1,9:1,1:1},4:{6:1,11:1,3:1,5:1,4:1,1:1},2:{6:1,3:1,4:1,7:1,9:1,1:1},6:{6:1,11:1,3:1,7:1,1:1},8:{6:1,3:1,8:1,5:1,4:1,7:1,1:1},5:{6:1,8:1,5:1,4:1,9:1,1:1}};return n?isNaN(n)?n:"?profile=avatar"+(i?"&size="+i:"")+"&id="+n+("tiny"==i?".gif":".jpg"):g_file_races[t]&&g_file_classes[e]&&g_file_genders[o]&&l[t]&&l[t][e]&&!(6==e&&r<55)?"chr_"+g_file_races[t]+"_"+g_file_genders[o]+"_"+g_file_classes[e]+"0"+(r>59?Math.floor((r-60)/10)+2:1):"inv_misc_questionmark"};