var MARKUP_MODE_COMMENT=1,MARKUP_MODE_ARTICLE=2,MARKUP_MODE_QUICKFACTS=3,MARKUP_MODE_SIGNATURE=4,MARKUP_MODE_REPLY=5,MARKUP_CLASS_ADMIN=40,MARKUP_CLASS_STAFF=30,MARKUP_CLASS_PREMIUM=20,MARKUP_CLASS_USER=10,MARKUP_CLASS_PENDING=1,MARKUP_SOURCE_LIVE=1,MARKUP_SOURCE_PTR=2,MARKUP_SOURCE_BETA=3,MarkupModeMap={};MarkupModeMap[MARKUP_MODE_COMMENT]="comment",MarkupModeMap[MARKUP_MODE_REPLY]="reply",MarkupModeMap[MARKUP_MODE_ARTICLE]="article",MarkupModeMap[MARKUP_MODE_QUICKFACTS]="quickfacts",MarkupModeMap[MARKUP_MODE_SIGNATURE]="signature";var MarkupSourceMap={};MarkupSourceMap[MARKUP_SOURCE_LIVE]="live",MarkupSourceMap[MARKUP_SOURCE_PTR]="ptr",MarkupSourceMap[MARKUP_SOURCE_BETA]="beta";var MarkupDomainRegexMap={betaPtrLang:/^(beta|legion|wod|mop|ptr|www|ko|fr|de|cn|es|ru|pt|it)$/,lang:/^(www|fr|de|cn|es|ru)$/},Markup={MODE_COMMENT:MARKUP_MODE_COMMENT,MODE_REPLY:MARKUP_MODE_REPLY,MODE_ARTICLE:MARKUP_MODE_ARTICLE,MODE_QUICKFACTS:MARKUP_MODE_QUICKFACTS,MODE_SIGNATURE:MARKUP_MODE_SIGNATURE,SOURCE_LIVE:MARKUP_SOURCE_LIVE,SOURCE_PTR:MARKUP_SOURCE_PTR,SOURCE_BETA:MARKUP_SOURCE_BETA,CLASS_ADMIN:MARKUP_CLASS_ADMIN,CLASS_STAFF:MARKUP_CLASS_STAFF,CLASS_PREMIUM:MARKUP_CLASS_PREMIUM,CLASS_USER:MARKUP_CLASS_USER,CLASS_PENDING:MARKUP_CLASS_PENDING,whitelistedWebsites:[new RegExp("(.*\\.)?"+location.hostname,"i"),/(.*\.)?wowhead.com/i,/(.*\.)?thottbot.com/i,/(.*\.)?torhead.com/i,/(.*\.)?mmoui.com/i,/(.*\.)?tankspot.com/i,/(.*\.)?guildfans.com/i,/(.*\.)?allakhazam.com/i,/(.*\.)?zam.com/i,/(.*\.)?blizzard.com/i,/(.*\.)?worldofwarcraft.com/i,/(.*\.)?wow-europe.com/i,/(.*\.)?battle.net/i,/(.*\.)?sc2ranks.com/i,/(.*\.)?torchlightarmory.com/i,/(.*\.)?vindictusdb.com/i,/(.*\.)?wowinterface.com/i,/(.*\.)?vginterface.com/i,/(.*\.)?lotrointerface.com/i,/(.*\.)?eq2interface.com/i,/(.*\.)?eqinterface.com/i,/(.*\.)?mmo-champion.com/i,/(.*\.)?joystiq.com/i,/(.*\.)?wow-heroes.com/i,/(.*\.)?be-imba.hu/i,/(.*\.)?wowpedia.org/i,/(.*\.)?curse.com/i,/(.*\.)?elitistjerks.com/i,/(.*\.)?wowwiki.com/i,/(.*\.)?worldoflogs.com/i,/(.*\.)?wowinsider.com/i,/(.*\.)?guildwork.com/i],rolesToClass:function(e){return e&(U_GROUP_ADMIN|U_GROUP_VIP|U_GROUP_DEV)?Markup.CLASS_ADMIN:e&U_GROUP_STAFF?Markup.CLASS_STAFF:e&U_GROUP_PREMIUM?Markup.CLASS_PREMIUM:e&U_GROUP_PENDING?Markup.CLASS_PENDING:Markup.CLASS_USER},defaultSource:!1,nameCol:"name_enus",domainToLocale:{www:"enus",ptr:"ptr",beta:"beta",mop:"beta",fr:"frfr",de:"dede",cn:"zhcn",es:"eses",ru:"ruru",pt:"ptbr"},maps:[],firstTags:{},postTags:[],collectTags:{},excludeTags:{},tooltipTags:{},tooltipBare:{},attributes:{id:{req:!1,valid:/^[a-z0-9_-]+$/i},title:{req:!1,valid:/[\S ]+/},class:{req:!1,valid:/\S+/}},youtube:{players:[],APIIsReady:!1,readyTimeout:void 0,APIReady:function(){var e=!1;Markup.youtube.readyTimeout=void 0,Markup.youtube.APIIsReady=!0;for(var a in Markup.youtube.players)Markup.youtube.players.hasOwnProperty(a)&&(Markup.youtube.players[a].loaded||($WH.ge(Markup.youtube.players[a].containerId)?(Markup.youtube.players[a].loaded=!0,Markup.youtube.players[a].player=new YT.Player(Markup.youtube.players[a].containerId,Markup.youtube.players[a].yt)):e=!0));e&&(Markup.youtube.readyTimeout=window.setTimeout(Markup.youtube.APIReady,500))}},IsLinkAllowed:function(e){var a=e.match("[a-z]+://([a-z0-9.-]+)");if(!a)return!0;var t=a[1],r=!1;for(var i in Markup.whitelistedWebsites){var n=Markup.whitelistedWebsites[i];0==t.search(n)&&(r=!0)}return r},tags:{"<text>":{empty:!0,noHelp:!0,allowInReplies:!0,toHtml:function(e,a){if(a=a||$.noop," "!=e._text||a.noNbsp||(e._text="&nbsp;"),e._text=e._text.replace(/\\\[/g,"["),a&&a.noLink)return e._text;if(a&&a.needsRaw)return e._rawText;var t=[],r=Markup._preText(e._rawText.replace(/(https?:\/\/|www\.)([\/_a-z0-9\%\?#@\-\+~&=;:']|\.[a-z0-9\-])+/gi,function(e){matchUrl=Markup._preText(e.replace(/^www/,"http://www")),e=Markup._preText(e);var a=t.length;return t.push([matchUrl,e]),"$L"+a}));r=r.replace(/\$L([\d+]) /gi,"$L$1&nbsp;");for(var i in t)r=r.replace("$L"+i,function(e){if(Markup.allow<Markup.CLASS_USER&&!Markup.IsLinkAllowed(t[i][0]))return $WH.sprintf('<span class="tip" onmouseover="$WH.Tooltip.showAtCursor(event, LANG.linkremoved_tip, 0, 0, \'q\')" onmousemove="$WH.Tooltip.cursorUpdate(event)" onmouseout="$WH.Tooltip.hide()">[$1]</span>',LANG.linkremoved);var a='<a href="'+t[i][0]+'"';return Markup._isUrlExternal(t[i][0])&&(a+=' target="_blank"'),a+=">"+t[i][1]+"</a>"});return r},toText:function(e){return e._text}},achievement:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},diff:{req:!1,valid:/^[0-9]+$/},icon:{req:!1,valid:/^false$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang},tempname:{req:!1}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1],n=[],l=null;if(e.diff&&n.push("diff="+e.diff),e.tempname&&(l=e.tempname),g_achievements[a]&&g_achievements[a][i]){var s=g_achievements[a];return'<a href="'+r+"?achievement="+a+'"'+(n.length?' rel="'+n.join("&")+'"':"")+(e.icon?"":' class="icontiny"><img src="'+g_staticDataUrl+"/images/wow/icons/tiny/"+s.icon.toLowerCase()+'.gif"')+Markup._addGlobalAttributes(e)+' align="absmiddle" /> <span class="tinyicontxt">'+Markup._safeHtml(s[i])+"</span></a>"}return'<a href="'+r+"?achievement="+a+'"'+(n.length?' rel="'+n.join("&")+'"':"")+Markup._addGlobalAttributes(e)+">"+(l||"("+LANG.types[10][0]+" #"+a+")")+"</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=(t[0],t[1]);return g_achievements[a]&&g_achievements[a][r]?Markup._safeHtml(g_achievements[a][r]):LANG.types[10][0]+" #"+a}},achievementpoints:{empty:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/}},allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){return'<span class="moneyachievement tip" onmouseover="Listview.funcBox.moneyAchievementOver(event)" onmousemove="$WH.Tooltip.cursorUpdate(event)" onmouseout="$WH.Tooltip.hide()"'+Markup._addGlobalAttributes(e)+">"+e.unnamed+"</span>"}},anchor:{empty:!0,ltrim:!0,rtrim:!0,attr:{unnamed:{req:!1,valid:/\S+/}},validate:function(e){return!(!e.unnamed&&!e.id)},toHtml:function(e){return!e.unnamed&&e.id&&(e.unnamed=e.id,e.id=null),'<a name="'+e.unnamed+'"'+Markup._addGlobalAttributes(e)+"></a>"}},acronym:{empty:!1,attr:{unnamed:{req:!1}},toHtml:function(e){return['<span class="tip" onmouseover="$WH.Tooltip.showAtCursor(event, \''+Markup._safeHtml(e.unnamed)+'\', 0, 0, \'q1\');" onmousemove="$WH.Tooltip.cursorUpdate(event)" onmouseout="$WH.Tooltip.hide()" '+Markup._addGlobalAttributes(e)+">","</span>"]}},b:{empty:!1,allowInReplies:!0,toHtml:function(e){return["<b"+Markup._addGlobalAttributes(e)+">","</b>"]},fromHtml:function(e){return e.replace(/<(b|big|strong)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[b]$2[/b]")}},blip:{empty:!0,attr:{unnamed:{req:!0,valid:/\S+/}},allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){var a="http://blip.tv/play/"+e.unnamed,t="";return t+='<embed width="600" height="368" src="'+a+'" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" wmode="opaque"></embed>'}},br:{empty:!0,toHtml:function(e){return"<br />"},fromHtml:function(e){return e.replace(/<br\b[\s\S]*?>/gi,"\n")}},class:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},icon:{req:!1,valid:/^false$/i},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return(!e.domain&&!e.site||!Markup.dbpage)&&(e.unnamed>=1&&e.unnamed<=11)},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1];if(g_classes[a]&&g_classes[a][i]){var n=g_classes[a];return'<a href="'+r+"?class="+a+'"'+(e.icon?"":' class="icontiny c'+a+'"><img src="'+g_staticDataUrl+"/images/wow/icons/tiny/"+g_classes.getIcon(a)+'.gif"')+Markup._addGlobalAttributes(e)+' align="absmiddle" /> <span class="tinyicontxt">'+Markup._safeHtml(n[i])+"</span></a>"}return'<a href="'+r+"?class="+a+'" class="c'+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[13][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_classes[a]&&g_classes[a][r]?Markup._safeHtml(g_classes[a][r]):LANG.types[13][0]+" #"+a}},code:{block:!0,empty:!1,rtrim:!0,itrim:!0,helpText:!0,allowedChildren:{"<text>":1},toHtml:function(e){var a='<pre class="code';return e.first&&(a+=" first"),e.last&&(a+=" last"),a+='"'+Markup._addGlobalAttributes(e)+">",[a,"</pre>"]}},color:{empty:!1,attr:{unnamed:{req:!0,valid:/^.*/i}},allowedClass:MARKUP_CLASS_STAFF,extraColors:{deathknight:"c6",dk:"c6",druid:"c11",hunter:"c3",mage:"c8",paladin:"c2",priest:"c5",rogue:"c4",shaman:"c7",warlock:"c9",warrior:"c1",poor:"q0",common:"q1",uncommon:"q2",rare:"q3",epic:"q4",legendary:"q5",artifact:"q6",heirloom:"q7"},toHtml:function(e){var a=/^(aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|purple|red|silver|teal|white|yellow|c\d+|r\d+|q\d*?|#[a-f0-9]{6})$/i,t="<span ";if(e.unnamed.match(a))if("#00C0FF"==e.unnamed)t+='class="blizzard-blue"'+Markup._addGlobalAttributes(e);else{var r=e.unnamed.charAt(0);t+=("q"==r||"c"==r||"r"==r&&"red"!=e.unnamed?'class="':'style="color: ')+e.unnamed+'"'+Markup._addGlobalAttributes(e)}else Markup.tags.color.extraColors[e.unnamed]&&(t+='class = "'+Markup.tags.color.extraColors[e.unnamed]+'"');return t+=">",[t,"</span>"]}},currency:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},amount:{req:!1,valid:/^[0-9\:]+$/},icon:{req:!1,valid:/^false$/i},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},allowedClass:MARKUP_CLASS_STAFF,validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1];if(g_gatheredcurrencies[a]&&g_gatheredcurrencies[a][i]){var n=g_gatheredcurrencies[a];return e.amount?'<a href="'+r+"?currency="+a+'"'+(e.icon?"":' class="icontinyr tip q1" onmouseover="$WH.Tooltip.showAtCursor(event, \''+Markup._safeHtml(n[i])+'\', 0, 0, \'q1\');" onmousemove="$WH.Tooltip.cursorUpdate(event)" onmouseout="$WH.Tooltip.hide()" style="background-image:url('+g_staticDataUrl+"/images/wow/icons/tiny/"+n.icon[0].toLowerCase()+".gif)")+Markup._addGlobalAttributes(e)+'"> <span class="tinyicontxt">'+e.amount.split(":").join(" - ")+"</span></a>":'<a href="'+r+"?currency="+a+'"'+(e.icon?"":' class="icontiny q1"><span><img src="'+g_staticDataUrl+"/images/wow/icons/tiny/"+n.icon[0].toLowerCase()+'.gif"')+Markup._addGlobalAttributes(e)+' align="absmiddle" /> <span class="tinyicontxt">'+Markup._safeHtml(n[i])+"</a>"}return'<a href="'+r+"?currency="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[17][0]+" #"+a+")</a>"+(e.amount>0?" x"+e.amount:"")},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_gatheredcurrencies[a]&&g_gatheredcurrencies[a][r]?Markup._safeHtml(g_gatheredcurrencies[a][r]):LANG.types[17][0]+" #"+a}},db:{empty:!0,attr:{unnamed:{req:!0,valid:/^(live|ptr|beta|mop)$/}},allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){return"live"==e.unnamed?Markup.defaultSource=Markup.SOURCE_LIVE:"ptr"==e.unnamed?Markup.defaultSource=Markup.SOURCE_PTR:"beta"!=e.unnamed&&"mop"!=e.unnamed||(Markup.defaultSource=Markup.SOURCE_BETA),""},toText:function(e){return"live"==e.unnamed?Markup.defaultSource=Markup.SOURCE_LIVE:"ptr"==e.unnamed?Markup.defaultSource=Markup.SOURCE_PTR:"beta"!=e.unnamed&&"mop"!=e.unnamed||(Markup.defaultSource=Markup.SOURCE_BETA),""}},del:{empty:!1,attr:{copy:{req:!1,valid:/^true$/}},toHtml:function(e){var a='<del class="diffmod"'+Markup._addGlobalAttributes(e);return e.copy||(a+=' unselectable="on"'),a+=">",[a,"</del>"]}},div:{empty:!1,block:!0,ltrim:!0,rtrim:!0,itrim:!0,attr:{clear:{req:!1,valid:/^(left|right|both)$/i},unnamed:{req:!1,valid:/^hidden$/i},float:{req:!1,valid:/^(left|right)$/i},align:{req:!1,valid:/^(left|right|center)$/i},margin:{req:!1,valid:/^\d+(px|em|\%)$/},style:{req:!1,valid:/^[^"<>]+$/},width:{req:!1,valid:/^[0-9]+(px|em|\%)$/}},allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){var a="<div"+Markup._addGlobalAttributes(e),t=[],r=[];return e.clear&&t.push("clear: "+e.clear),e.unnamed&&t.push("display: none"),e.width&&t.push("width: "+e.width),e.float&&r.push("markup-float-"+e.float),e.align&&t.push("text-align: "+e.align),e.margin&&t.push("margin: "+e.margin),e.style&&Markup.allow>=Markup.CLASS_STAFF&&t.push(e.style),e.first&&r.push("first"),e.last&&r.push("last"),t.length>0&&(a+=' style="'+t.join(";")+'"'),r.length>0&&(a+=' class="'+r.join(" ")+'"'),a+=">",[a,"</div>"]},fromHtml:function(e,a){a=a||0;var t;if(t=Markup.matchOuterTags(e,"<div\\b[\\s\\S]*?>","</div>","g"))for(var r=0;r<t.length;++r){var i=t[r][1].match(/float:\s*(left|right)"/i),n=t[r][1].match(/width[:="]+\s*([0-9]+)/i);e=e.replace(t[r][1]+t[r][0]+t[r][2],"\n"+Array(a+1).join("\t")+"[div"+(i?" float="+i[1]:"")+(n?" width="+n[1]:"")+"]"+Markup.tags.div.fromHtml(t[r][0],a+1)+"[/div]")}return e}},emote:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1];return g_emotes[a]&&g_emotes[a][i]?'<a href="'+r+"?emote="+a+'"'+Markup._addGlobalAttributes(e)+">"+Markup._safeHtml(g_emotes[a][i])+"</a>":'<a href="'+r+"?emote="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[501][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_emotes[a]&&g_emotes[a][r]?Markup._safeHtml(g_emotes[a][r]):LANG.types[501][0]+" #"+a}},enchantment:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1];return g_enchantments[a]&&g_enchantments[a][i]?'<a href="'+r+"?enchantment="+a+'"'+Markup._addGlobalAttributes(e)+">"+Markup._safeHtml(g_enchantments[a][i])+"</a>":'<a href="'+r+"?enchantment="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[502][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_enchantments[a]&&g_enchantments[a][r]?Markup._safeHtml(g_enchantments[a][r]):LANG.types[502][0]+" #"+a}},event:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^-?[0-9]+$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},allowedClass:MARKUP_CLASS_STAFF,validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1];if(g_holidays[a]&&g_holidays[a][i]){var n=g_holidays[a];return'<a href="'+r+"?event="+a+'"'+Markup._addGlobalAttributes(e)+">"+Markup._safeHtml(n[i])+"</a>"}return'<a href="'+r+"?event="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[12][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_holidays[a]&&g_holidays[a][r]?Markup._safeHtml(g_holidays[a][r]):LANG.types[12][0]+" #"+a}},faction:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1];if(g_factions[a]&&g_factions[a][i]){var n=g_factions[a];return'<a href="'+r+"?faction="+a+'"'+Markup._addGlobalAttributes(e)+">"+Markup._safeHtml(n[i])+"</a>"}return'<a href="'+r+"?faction="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[8][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_factions[a]&&g_factions[a][r]?Markup._safeHtml(g_factions[a][r]):LANG.types[8][0]+" #"+a}},feedback:{empty:!0,allowedClass:MARKUP_CLASS_STAFF,attr:{mailto:{req:!1,valid:/^true$/i}},toHtml:function(e){return'<b><span class="icontiny" style="background-image: url('+g_staticDataUrl+'/images/icons/email.gif)"><a href="'+(e.mailto?"mailto:feedback@wowhead.com":'javascript:;" onclick="ContactTool.show();')+'">feedback@wowhead.com</a></span></b>'}},forumrules:{empty:!0,allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){return'<b><span class="icontiny" style="background-image: url('+g_staticDataUrl+'/images/icons/favicon.gif)"><a href="http://www.wowhead.com/forums&topic=2">forum rules</a></span></b>'}},hr:{empty:!0,trim:!0,allowedModes:{article:1,quickfacts:1,comment:1},toHtml:function(e){return"<hr />"},fromHtml:function(e){return e.replace(/<hr\b[\s\S]*?>/gi,"[hr]")}},h2:{block:!0,empty:!1,ltrim:!0,rtrim:!0,itrim:!0,allowedClass:MARKUP_CLASS_STAFF,attr:{unnamed:{req:!1,valid:/^first$/i},clear:{req:!1,valid:/^(true|both|left|right)$/i},style:{req:!1,valid:/^[^"<>]+$/},toc:{req:!1,valid:/^false$/i}},toHtml:function(e){e.id||(e.id=g_urlize(e._textContents)),str="<h2"+Markup._addGlobalAttributes(e);var a=[];(e.first||e.unnamed)&&a.push("first"),e.last&&a.push("last"),a.length>0&&(str+=' class="'+a.join(" ")+'"');var t=[];return e.clear&&("true"==e.clear||"both"==e.clear?t.push("clear: both"):t.push("clear: "+e.clear)),e.style&&Markup.allow>=Markup.CLASS_STAFF&&t.push(e.style),t.length&&(str+=' styles="'+t.join(";")+'"'),[str+">","</h2>"]},fromHtml:function(e){return e.replace(/<h2\b[\s\S]*?>([\s\S]*?)<\/h2>/gi,"\n[h2]$1[/h2]")}},h3:{block:!0,empty:!1,ltrim:!0,rtrim:!0,itrim:!0,attr:{unnamed:{req:!1,valid:/^first$/i},style:{req:!1,valid:/^[^"<>]+$/},toc:{req:!1,valid:/^false$/i}},allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){e.id||(e.id=g_urlize(e._textContents));var a="<h3"+Markup._addGlobalAttributes(e),t=[];(e.first||e.unnamed)&&t.push("first"),e.last&&t.push("last"),t.length>0&&(a+=' class="'+t.join(" ")+'"');var r=[];return e.style&&Markup.allow>=Markup.CLASS_STAFF&&r.push(e.style),r.length&&(a+=' styles="'+r.join(";")+'"'),[a+">","</h3>"]},fromHtml:function(e){return e.replace(/<h3\b[\s\S]*?>([\s\S]*?)<\/h3>/gi,"\n[h3]$1[/h3]")}},html:{empty:!1,allowedClass:MARKUP_CLASS_ADMIN,allowedChildren:{"<text>":1},rawText:!0,taglessSkip:!0,toHtml:function(e){return[e._contents]}},i:{empty:!1,allowInReplies:!0,toHtml:function(e){return["<i"+Markup._addGlobalAttributes(e)+">","</i>"]},fromHtml:function(e){return e.replace(/<(i|em)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[i]$2[/i]")}},icon:{empty:!1,itrim:!0,attr:{align:{req:!1,valid:/^right$/i},float:{req:!1,valid:/^(left|right)$/i},name:{req:!1,valid:/\S+/},size:{req:!1,valid:/^(tiny|small|medium|large)$/},unnamed:{req:!1,valid:/^class$/i},url:{req:!1,valid:/\S+/},preset:{req:!1,valid:/\S+/}},allowedClass:MARKUP_CLASS_STAFF,presets:{boss:g_staticDataUrl+"/images/icons/boss.gif",heroic:g_staticDataUrl+"/images/icons/heroic.gif"},validate:function(e){return!!(e.name||e.url||e.preset)&&!(e.preset&&!Markup.tags.icon.presets[e.preset])},toHtml:function(e){var a=e.size?e.size:"tiny";if(e.name||(e.name=""),"tiny"==a){var t="<span"+Markup._addGlobalAttributes(e)+' class="';if(void 0==e.unnamed){t+="icontiny",e.align&&(t+="r");var r="";if(e.name)r=g_staticDataUrl+"/images/wow/icons/tiny/"+e.name.toLowerCase()+".gif";else if(e.preset)r=Markup.tags.icon.presets[e.preset];else{if(!e.url||!Markup._isUrlSafe(e.url))return"";r=e.url}t+='" style="background-image: url('+r+')">'}else t+=e.name+'">';return[t,"</span>"]}var t="<div"+Markup._addGlobalAttributes(e)+' onclick="Icon.showIconName(this)" class="icon'+a+(e.float?'" style="float: '+e.float+';">':'">'),i={small:0,medium:1,large:2},n=null;return e.url&&Markup._isUrlSafe(e.url)?n=e.url:e._textContents&&Markup._isUrlSafe(e._textContents)&&(n=e._textContents),icon=Icon.create(e.name.toLowerCase(),i[a],null,n),t+=icon.innerHTML+"</div>",[t]}},icondb:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},block:{req:!1,valid:/^(true|false)$/},size:{req:!1,valid:/^(tiny|small|medium|large)$/},name:{req:!1,valid:/^true$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang},diff:{req:!1,valid:/^[0-9]+$/},tempname:{req:!1}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.size?e.size:"small",t="true"==e.name,r=e.unnamed,i=Markup._getDatabaseDomainInfo(e),n=i[0],l=n+"?icon="+r,s=[],o=null;if(e.diff,s.push("diff="+e.diff),e.tempname&&(o=e.tempname),g_icons[r]&&g_icons[r].name){var u=g_icons[r];if(t){if("tiny"==a)return'<a href="'+l+'"'+(s.length?' rel="'+s.join("&")+'"':"")+(e.icon?"":' class="icontiny"><img src="'+g_staticDataUrl+"/images/wow/icons/tiny/"+u.icon.toLowerCase()+'.gif" align="absmiddle"')+Markup._addGlobalAttributes(e)+"> "+Markup._safeHtml(u.name)+"</a>";var d=$WH.ce("a",{href:l}),p=$WH.ce("div",null,d);return $WH.ae(d,Icon.create(u.name,Icon.sizeIds[a],null,!1,null,null,null,null,!0)),d.innerHTML+=Markup._safeHtml(u.name),p.innerHTML}var p=$WH.ce("div");return $WH.ae(p,Icon.create(u.name,Icon.sizeIds[a],null,l,null,null,null,null,"true"!=e.block)),p.innerHTML}return'<a href="'+l+'"'+(s.length?' rel="'+s.join("&")+'"':"")+Markup._addGlobalAttributes(e)+">"+(o||"("+LANG.types[29][0]+" #"+r+")")+"</a>"},toText:function(e){var a=e.unnamed;return g_icons[a]&&g_icons[a].name?Markup._safeHtml(g_icons[a].name):LANG.types[29][0]+" #"+a}},iconlist:{empty:!1,block:!0,ltrim:!0,rtrim:!0,attr:{domain:{req:!1,valid:MarkupDomainRegexMap.lang}},taglessSkip:!0,allowedClass:MARKUP_CLASS_STAFF,allowedChildren:{b:1,achievement:1,currency:1,faction:1,holiday:1,item:1,itemset:1,npc:1,object:1,pet:1,quest:1,spell:1,title:1,zone:1},toHtml:function(e){for(var a,t=Markup._getDatabaseDomainInfo(e)[2],r="",i=0;i<e._nodes.length;++i){var n=$WH.dO(e._nodes[i]);n.attr.domain=t;var l=Markup.tags[n.name].toHtml(n.attr),s=(n.name,""),o="";"string"!=typeof l?l=l[0]+n.attr._contents+l[1]:"string"==typeof l&&(a=l.match(/href="(.+?)".+?url\(\/images\/wow\/icons\/tiny\/(.+?)\.gif\)/))&&(n.attr.icon="false",l=Markup.tags[n.name].toHtml(n.attr),s=a[1],o=a[2]),l&&(r+="<tr><th>"+(o?Markup.toHtml("[icon name="+o+" size=small url="+s+"]",{skipReset:!0}):"<ul><li>&nbsp;</li></ul>")+"</th><td>"+l+"</td></tr>")}return r&&(r='<div class="iconlist-col"><table class="iconlist">'+r+"</table></div>"),[r]}},img:{empty:!0,attr:{src:{req:!1,valid:/\S+/},icon:{req:!1,valid:/\S+/},id:{req:!1,valid:/^[0-9]+$/},blog:{req:!1,valid:/^[0-9]+$/},size:{req:!1,valid:/^(thumb|resized|normal|large|medium|small|tiny)$/i},width:{req:!1,valid:/^[0-9]+$/},height:{req:!1,valid:/^[0-9]+$/},float:{req:!1,valid:/^(left|right|center)$/i},border:{req:!1,valid:/^[0-9]+$/},shadow:{req:!1,valid:/^(true|false)$/},margin:{req:!1,valid:/^[0-9]+$/}},blogSize:/^(thumb|normal)$/i,idSize:/^(thumb|resized|normal)$/i,iconSize:/^(large|medium|small|tiny)$/i,allowedClass:MARKUP_CLASS_STAFF,validate:function(e){return!!e.src||(e.id?!e.size||Markup.tags.img.idSize.test(e.size):e.icon?!e.size||Markup.tags.img.iconSize.test(e.size):!!e.blog&&(!e.size||Markup.tags.img.blogSize.test(e.size)))},toHtml:function(e){var a="<img"+Markup._addGlobalAttributes(e),t=[],r=[],i="";if(e.src)a+=' src="'+e.src+'"';else if(e.id)a+=' src="'+g_staticUrl+"/uploads/screenshots/"+(e.size?e.size:"normal")+"/"+e.id+'.jpg"';else if(e.icon)a+=' src="'+g_staticDataUrl+"/images/wow/icons/"+(e.size?e.size:"large")+"/"+e.icon+'.jpg"';else if(e.blog){if(!g_blogimages[e.blog])return"Image #"+e.blog;var n=g_blogimages[e.blog];if(e.size&&"thumb"==e.size){var l=g_staticUrl+"/uploads/blog/images/"+e.blog+(3==n.type?".png":".jpg");a+=' src="'+g_staticUrl+"/uploads/blog/thumbs/"+e.blog+(3==n.type?".png":".jpg")+'" alt="'+Markup._safeHtml(n.alt)+'" width="'+n.thumbwidth+'" height="'+n.thumbheight+'"',g_screenshots[Markup.uid]||(g_screenshots[Markup.uid]=[]),a='<a href="'+l+'" onclick="if(!g_isLeftClick(event)) return; ScreenshotViewer.show({screenshots: \''+Markup.uid+"', pos: "+g_screenshots[Markup.uid].length+'}); return false;">'+a,i="</a>";var s={url:l,caption:n.alt,width:n.width,height:n.height,noMarkup:!0};g_screenshots[Markup.uid].push(s)}else a+=' src="'+g_staticUrl+"/uploads/blog/images/"+e.blog+(3==n.type?".png":".jpg")+'" alt="'+Markup._safeHtml(n.alt)+'" width="'+n.width+'" height="'+n.height+'"'}return e.width&&(a+=' width="'+e.width+'"'),e.height&&(a+=' height="'+e.height+'"'),e.float&&("center"==e.float?(a='<div style="text-align: center">'+a+' style="margin: 10px auto"',i="</div>"):(r.push("float: "+e.float),e.margin||(e.margin=10),"left"==e.float?r.push("margin: 0 "+e.margin+"px "+e.margin+"px 0"):r.push("margin: 0 0 "+e.margin+"px "+e.margin+"px"))),e.border?0==e.border?t.push("no-border"):(t.push("border"),r.push("border-width:"+e.border+"px")):(t.push("content-image"),"true"==e.shadow&&t.push("content-image-shadowed")),e.title?a+=' alt="'+e.title+'"':a+=' alt=""',t.length&&(a+=' class="'+t.join(" ")+'"'),r.length&&(a+=' style="'+r.join(";")+'"'),a+=" />"+i},fromHtml:function(e){var a;if(a=e.match(/<img\b[\s\S]*?src="[\s\S]+?"[\s\S]*?>/gi))for(var t=0;t<a.length;++t){var r=a[t].match(/src="([\s\S]+?)"/i),i=a[t].match(/width[:="]+\s*([0-9]+)/i),n=a[t].match(/height[:="]+\s*([0-9]+)/i),l=a[t].match(/border[:="]+\s*([0-9]+)/i);e=e.replace(a[t],"[img src="+r[1]+(i?" width="+i[1]:"")+(n?" height="+n[1]:"")+" border="+(l?l[1]:0)+"]")}return e}},ins:{empty:!1,toHtml:function(e){return['<ins class="diffmod"'+Markup._addGlobalAttributes(e)+">","</ins>"]}},item:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},icon:{req:!1,valid:/^false$/i},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang},tempname:{req:!1}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1],n=null;if(e.tempname&&(n=e.tempname),g_items[a]&&g_items[a][i]){var l=g_items[a],s="<a"+Markup._addGlobalAttributes(e)+' href="'+r+"?item="+a+'" class="q'+l.quality+(e.icon?"":' icontiny"><img src="'+g_staticDataUrl+"/images/wow/icons/tiny/"+l.icon.toLowerCase()+'.gif"')+' align="absmiddle" /> <span class="tinyicontxt">';return s+=Markup._safeHtml(l[i])+"</span></a>"}return'<a href="'+r+"?item="+a+'"'+Markup._addGlobalAttributes(e)+">"+(n||"("+LANG.types[3][0]+" #"+a+")")+"</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_items[a]&&g_items[a][r]?Markup._safeHtml(g_items[a][r]):LANG.types[3][0]+" #"+a}},itemset:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^-?[0-9]+$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1];if(g_itemsets[a]&&g_itemsets[a][i]){var n=g_itemsets[a];return'<a href="'+r+"?itemset="+a+'"'+Markup._addGlobalAttributes(e)+">"+Markup._safeHtml(n[i])+"</a>"}return'<a href="'+r+"?itemset="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[4][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_itemsets[a]&&g_itemsets[a][r]?Markup._safeHtml(g_itemsets[a][r]):LANG.types[4][0]+" #"+a}},li:{empty:!1,itrim:!0,allowedParents:{ul:1,ol:1},attr:{class:{req:!1,valid:/^[a-z0-9 _-]+$/i},style:{req:!1,valid:/^[^<>]+$/}},helpText:function(){var e="";e+="[ul]";for(var a=0;a<3;++a)e+="\n[li]"+LANG.markup_li+"[/li]";e+="\n[/ul]\n\n",e+="[ol]";for(var a=0;a<3;++a)e+="\n[li]"+LANG.markup_li+"[/li]";return e+="\n[/ol]\n",e.toLowerCase()},toHtml:function(e){return["<li"+Markup._addGlobalAttributes(e)+"><div>","</div></li>"]},fromHtml:function(e,a){a=a||0;var t;if(t=Markup.matchOuterTags(e,"<li\\b[\\s\\S]*?>","</li>","g"))for(var r=0;r<t.length;++r)e=e.replace(t[r][1]+t[r][0]+t[r][2],"\n\t"+Array(a+1).join("\t")+"[li]"+Markup.tags.li.fromHtml(t[r][0],a+1)+"[/li]");return e}},lightbox:{empty:!1,allowedClass:MARKUP_CLASS_STAFF,attr:{unnamed:{req:!0,valid:/^(map|model|screenshot)$/},zone:{req:!1,valid:/^-?[0-9]+[a-z]?$/i},floor:{req:!1,valid:/^[0-9]+$/},pins:{req:!1,valid:/^[0-9]+$/}},validate:function(e){switch(e.unnamed){case"map":if(e.zone)return!0}return!1},toHtml:function(e){var a="",t="";switch(e.unnamed){case"map":a="?maps="+e.zone,e.floor&&(a+="."+e.floor),e.pins&&(a+=":"+e.pins);t="if(!g_isLeftClick(event)) return; MapViewer.show({ link: '"+a.substr(6)+"' }); return false;"}return a&&t?['<a href="'+a+'" onclick="'+t+'"'+Markup._addGlobalAttributes(e)+">","</a>"]:""}},map:{empty:!1,attr:{zone:{req:!0,valid:/^-?[0-9a-z\-_]+$/i},source:{req:!1,valid:/\S+/}},allowedClass:MARKUP_CLASS_STAFF,allowedChildren:{pin:1},toHtml:function(e){var a=e._contents;e.id="dsgdfngjkfdg"+Markup.maps.length;var t="<div"+Markup._addGlobalAttributes(e)+'></div><div style="clear: left"></div>';return Markup.maps.push([e.id,e.zone,a]),[t]}},n5:{empty:!0,attr:{unnamed:{req:!0,valid:/^[0-9\.]+$/}},toHtml:function(e){return GetN5(e.unnamed)}},pin:{empty:!1,attr:{url:{req:!1,valid:/\S+/},type:{req:!1,valid:/^[0-9]+$/},x:{req:!0,valid:/^[0-9]{1,2}(\.[0-9])?$/},y:{req:!0,valid:/^[0-9]{1,2}(\.[0-9])?$/},path:{req:!1,valid:/^([0-9]{1,2}(\.[0-9])?[,:]?)+$/}},taglessSkip:!0,allowedClass:MARKUP_CLASS_STAFF,allowedParents:{map:1},toHtml:function(e){e.url&&!Markup._isUrlSafe(e.url)&&(e.url="");var a=e._contents;e.url&&-1!=e.url.indexOf("npc=")&&(a='<b class="q">'+a+'</b><br /><span class="q2">Click to view this NPC</span>');var t=null;if(e.path)for(var r=e.path.split(":"),t=[],i=0,n=r.length;i<n;++i){var l=r[i].split(",");2==l.length&&t.push([parseFloat(l[0]||0),parseFloat(l[1]||0)])}return[[parseFloat(e.x||0),parseFloat(e.y||0),{label:a,url:e.url,type:e.type,lines:t}]]}},markupdoc:{empty:!0,attr:{tag:{req:!1,valid:/[a-z0-9]+/i},help:{req:!1,valid:/^(admin|staff|premium|user|pending)$/}},allowedClass:MARKUP_CLASS_STAFF,validate:function(e){return!(e.tag&&!Markup.tags[e.tag])},toHtml:function(e){var a="",t=!!e.help&&Markup["CLASS_"+e.help.toUpperCase()];if(t&&(a+=LANG.markup_helpdoc+'<div class="pad3"></div><table class="comment comment-markupdoc"><tr><th>'+LANG.markup_help1+"</th><th>"+LANG.markup_help2+"</th></tr>"),e.tag)a=Markup._generateTagDocs(e.tag,t);else for(var r in Markup.tags)t||""==a||(a+='<div class="pad3"></div>'),a+=Markup._generateTagDocs(r,t);return a+(t?"</table>":"")}},menu:{empty:!0,trim:!0,ltrim:!0,rtrim:!0,attr:{tab:{req:!0,valid:/^[0-9]+$/},path:{req:!0,valid:/\S+/}},allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){var a=e.path.split(",");PageTemplate.set({activeTab:e.tab,breadcrumb:a})}},minibox:{empty:!1,rtrim:!0,itrim:!0,attr:{float:{req:!1,valid:/^(left|right)$/i}},allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){var a="<div"+Markup._addGlobalAttributes(e)+' class="minibox';return"left"==e.float&&(a+=" minibox-left"),a+='">',[a,"</div>"]}},model:{empty:!1,attr:{item:{req:!1,valid:/^[0-9]+$/},object:{req:!1,valid:/^[0-9]+$/},npc:{req:!1,valid:/^[0-9]+$/},itemset:{req:!1,valid:/^[0-9,]+$/},slot:{req:!1,valid:/^[0-9]+$/},humanoid:{req:!1,valid:/^1$/},float:{req:!1,valid:/^(left|right)$/i},border:{req:!1,valid:/^[0-9]+$/},shadow:{req:!1,valid:/^(true|false)$/},img:{req:!1,valid:/\S+/},link:{req:!1,valid:/\S+/},label:{req:!1,valid:/[\S ]+/}},allowedClass:MARKUP_CLASS_STAFF,skipSlots:{4:1,5:1,6:1,7:1,8:1,9:1,10:1,16:1,19:1,20:1},toHtml:function(e){var a="",t=[],r=[];return e.float&&t.push("markup-float-"+e.float),e.border?0==e.border?t.push("no-border"):(t.push("border"),r.push("border-width:"+e.border+"px")):(t.push("content-image"),"true"==e.shadow&&t.push("content-image-shadowed")),
e.npc?(a="<a"+Markup._addGlobalAttributes(e)+' href="#modelviewer:1:'+e.npc+":"+(e.humanoid?"1":"0")+'" onclick="ModelViewer.show({ type: 1, displayId: '+e.npc+", slot: "+e.slot+", "+(e.humanoid?"humanoid: 1, ":"")+"displayAd: 1, fromTag: 1"+(e.link?", link: '"+Markup._safeJsString(e.link)+"'":"")+(e.label?", label: '"+Markup._safeJsString(e.label)+"'":"")+' });"><img alt="'+Markup._safeHtml(e._contents)+'" title="'+Markup._safeHtml(e._contents)+'" src="'+(e.img?e.img:g_staticDataUrl+"/modelviewer/thumbs/npc/"+e.npc+'.png" width="150" height="150"')+" ",t.length&&(a+='class="'+t.join(" ")+'"'),r.length&&(a+=' style="'+r.join(";")+'"'),a+="/></a>",[a]):e.object?(a="<a"+Markup._addGlobalAttributes(e)+' href="#modelviewer:2:'+e.object+'" onclick="ModelViewer.show({ type: 2, displayId: '+e.object+", displayAd: 1, fromTag: 1"+(e.link?", link: '"+Markup._safeJsString(e.link)+"'":"")+(e.label?", label: '"+Markup._safeJsString(e.label)+"'":"")+' });"><img alt="'+Markup._safeHtml(e._contents)+'" title="'+Markup._safeHtml(e._contents)+'" src="'+(e.img?e.img:g_staticDataUrl+"/modelviewer/thumbs/obj/"+e.object+'.png" width="150" height="150"')+" ",t.length&&(a+='class="'+t.join(" ")+'"'),r.length&&(a+=' style="'+r.join(";")+'"'),a+="/></a>",[a]):e.item&&e.slot?(a="<a"+Markup._addGlobalAttributes(e)+' href="#modelviewer:3:'+e.item+":"+e.slot+'" onclick="ModelViewer.show({ type: 3, displayId: '+e.item+", slot: "+e.slot+", displayAd: 1, fromTag: 1"+(e.link?", link: '"+Markup._safeJsString(e.link)+"'":"")+(e.label?", label: '"+Markup._safeJsString(e.label)+"'":"")+' });"><img alt="'+Markup._safeHtml(e._contents)+'" title="'+Markup._safeHtml(e._contents)+'" src="'+(e.img?e.img:g_staticDataUrl+"/modelviewer/thumbs/item/"+e.item+'.png" width="150" height="150"')+" ",t.length&&(a+='class="'+t.join(" ")+'"'),r.length&&(a+=' style="'+r.join(";")+'"'),a+="/></a>",[a]):e.itemset?(a="<a"+Markup._addGlobalAttributes(e)+' href="javascript:;" onclick="ModelViewer.show({ type: 4, equipList: ['+e.itemset+"], displayAd: 1, fromTag: 1"+(e.link?", link: '"+Markup._safeJsString(e.link)+"'":"")+(e.label?", label: '"+Markup._safeJsString(e.label)+"'":"")+' });">',[a,"</a>"]):["[model]","[/model]"]}},money:{empty:!0,attr:{unnamed:{req:!1,valid:/^[0-9]+$/},side:{req:!1,valid:/^(alliance|horde|both)$/i},items:{req:!1,valid:/^[0-9,]+$/},currency:{req:!1,valid:/^[0-9,]+$/},achievement:{req:!1,valid:/\S+/},arena:{req:!1,valid:/^[0-9]+$/},honor:{req:!1,valid:/^[0-9]+$/}},allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){var a=[],t=[];if(e.items){var r=e.items.split(",");if(r.length>=2)for(var i=0;i<r.length-1;i+=2)a.push([r[i],r[i+1]])}if(e.currency){var r=e.currency.split(",");if(r.length>=2)for(var i=0;i<r.length-1;i+=2)t.push([r[i],r[i+1]])}return e.honor&&t.push([104,e.honor]),e.arena&&t.push([103,e.arena]),g_getMoneyHtml(e.unnamed,e.side,a,t,e.achievement)}},npc:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1];if(g_npcs[a]&&g_npcs[a][i]){var n=g_npcs[a];return'<a href="'+r+"?npc="+a+'"'+Markup._addGlobalAttributes(e)+">"+Markup._safeHtml(n[i])+"</a>"}return'<a href="'+r+"?npc="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[1][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_npcs[a]&&g_npcs[a][r]?Markup._safeHtml(g_npcs[a][r]):LANG.types[1][0]+" #"+a}},object:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1];if(g_objects[a]&&g_objects[a][i]){var n=g_objects[a];return'<a href="'+r+"?object="+a+'"'+Markup._addGlobalAttributes(e)+">"+Markup._safeHtml(n[i])+"</a>"}return'<a href="'+r+"?object="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[2][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_objects[a]&&g_objects[a][r]?Markup._safeHtml(g_objects[a][r]):LANG.types[2][0]+" #"+a}},ol:{block:!0,empty:!1,ltrim:!0,rtrim:!0,itrim:!0,allowedChildren:{li:1},toHtml:function(e){var a="<ol",t=[];return e.first&&t.push("first"),e.last&&t.push("last"),t.length>0&&(a+=' class="'+t.join(" ")+'"'),a+=Markup._addGlobalAttributes(e)+">",[a,"</ol>"]},fromHtml:function(e,a){a=a||0;var t;if(t=Markup.matchOuterTags(e,"<ol\\b[\\s\\S]*?>","</ol>","g"))for(var r=0;r<t.length;++r)e=e.replace(t[r][1]+t[r][0]+t[r][2],"\n"+Array(a+1).join("\t")+"[ol]"+Markup.tags.ol.fromHtml(t[r][0],a+1)+"\n"+Array(a+1).join("\t")+"[/ol]");return e}},p:{empty:!1,ltrim:!0,rtrim:!0,itrim:!0,allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){return['<p style="line-height: 1.4em; margin: 1em 0px 0px 0px;"'+Markup._addGlobalAttributes(e)+">","</p>"]},fromHtml:function(e){var a;if(a=e.match(/<p\b[\s\S]*?>[\s\S]*?<\/p>/gi))for(var t=0;t<a.length;++t){var r=a[t].match(/^<p\b[\s\S]*?text-align:\s*(center|left|right)/i),i=a[t].match(/<p\b[\s\S]*?>([\s\S]*?)<\/p>/i);e=e.replace(a[t],"[pad][div"+(r?" align="+r[1]:"")+"]"+(i?i[1]:"")+"[/div][pad]")}return e}},pad:{empty:!0,block:!0,trim:!0,allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){var a='<div class="pad';return e.first&&(a+=" first"),e.last&&(a+=" last"),a+='"'+Markup._addGlobalAttributes(e)+"></div>"}},pet:{empty:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},icon:{req:!1,valid:/^false$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0];t[1];if(g_pet_families&&g_pet_families[a]&&g_pets&&g_pets[a]){var i="<span"+(e.icon?"":' class="icontiny" style="background-image: url('+g_staticDataUrl+"/images/wow/icons/tiny/"+g_pets[a].icon.toLowerCase()+".gif)")+'">';return i+='<a href="'+r+"?pet="+a+'"'+Markup._addGlobalAttributes(e)+">"+Markup._safeHtml(g_pet_families[a])+"</a></span>"}return'<a href="'+r+"?pet="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[9][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed;return g_pet_families&&g_pet_families[a]?Markup._safeHtml(g_pet_families[a]):LANG.types[9][0]+" #"+a}},pre:{empty:!1,block:!0,rtrim:!0,toHtml:function(e){var a='<pre class="code';return e.first&&(a+=" first"),e.last&&(a+=" last"),a+='"'+Markup._addGlobalAttributes(e)+">",[a,"</pre>"]},fromHtml:function(e){return e.replace(/<pre\b[\s\S]*?>([\s\S]*?)<\/pre>/gi,"[pre]$1[/pre]")}},quest:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},icon:{req:!1,valid:/^false$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1];if(g_quests[a]&&g_quests[a][i]){var n=g_quests[a];return'<a href="'+r+"?quest="+a+'"'+(e.icon?"":' class="icontiny"><img src="'+g_staticDataUrl+"/images/wow/icons/tiny/"+(n.daily?"quest_start_daily":"quest_start")+'.gif"')+Markup._addGlobalAttributes(e)+' align="absmiddle" /> <span class="tinyicontxt">'+Markup._safeHtml(n[i])+"</span></a>"}return'<a href="'+r+"?quest="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[5][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_quests[a]&&g_quests[a][r]?Markup._safeHtml(g_quests[a][r]):LANG.types[5][0]+" #"+a}},quote:{block:!0,empty:!1,rtrim:!0,ltrim:!0,itrim:!0,attr:{unnamed:{req:!1,valid:/[\S ]+/},url:{req:!1,valid:/\S+/},blizzard:{req:!1,valid:/^true$/},pname:{req:!1},wowhead:{req:!1,valid:/^true$/},display:{req:!1,valid:/^block$/},align:{req:!1,valid:/^(left|right|center)$/i},float:{req:!1,valid:/^(left|right|none)$/i},clear:{req:!1,valid:/^(left|right|both)$/i},collapse:{req:!1,valid:/^true$/}},allowedModes:{article:1,quickfacts:1,comment:1},validate:function(e){return!((e.blizzard||e.wowhead||e.collapse||e.url)&&Markup.allow<Markup.CLASS_STAFF)},toHtml:function(e){var a="<div"+Markup._addGlobalAttributes(e),t=[],r=["quote"];if(e.display&&t.push("display: "+e.display),e.align&&t.push("text-align: "+e.align),e.clear&&t.push("clear: "+e.clear),t.length&&(a+=' style="'+t.join("; ")+'" '),e.first&&r.push("first"),e.last&&r.push("last"),e.float&&r.push("markup-float-"+e.float),r.length&&(a+=' class="'+r.join(" ")),e.blizzard){if(e.unnamed&&e.blizzard){var i=Markup._fixUrl(e.url),n="View Original";i.indexOf("bluetracker")>=0&&(n="Blue Tracker"),void 0!==e.pname&&(n=e.pname);var l=e.unnamed.trim();if(l.length<=0)return["",""];a=a.replace('class="quote','class="quote-blizz'),a+=(e.collapse?" collapse":"")+'"><div class="quote-header">';var s=i.match(/https?:\/\/(us|eu)\.battle\.net\/wow\/en\/blog\/([0-9]+)/i)||i.match(/https?:\/\/(us|eu)\.battle\.net\/wow\/en\/forum\/topic\/([0-9]+)/i);if(s){a+='Originally posted by <strong>Blizzard</strong> (<a href="'+i+'" target="_blank">Official Post</a>';a+=' | <a href="http://www.wowhead.com/bluetracker?topic='+s[2]+'">Blue Tracker</a>)</div><div class="quote-body"><hr /><h2>'+l+"</h2>"}else a+=e.url&&Markup._isUrlSafe(e.url)?'Originally posted by <strong>Blizzard</strong> (<a href="'+Markup._fixUrl(e.url)+'" target="_blank">'+n+'</a>)</div><div class="quote-body"><hr />':"<h2>"+l+"</h2>";return[a,"</div></div>"]}return["",""]}if(e.wowhead)return a=a.replace('class="quote','class="quote-wh'),a+=(e.collapse?" collapse":"")+'">',a+='<div class="quote-body">',[a,"</div></div>"];if(a+='">',e.unnamed){var l=e.unnamed.trim();l.length>0&&(a+="<small><b>",e.url&&Markup._isUrlSafe(e.url)?a+='<a href="'+Markup._fixUrl(e.url)+'"'+(Markup._isUrlExternal(e.url)?' target="_blank"':"")+">"+l+"</a>":g_isUsernameValid(l)?a+='<a href="?user='+l+'">'+l+"</a>":a+=l,a+="</b> "+LANG.markup_said+'</small><div class="pad"></div>')}return[a,"</div>"]}},race:{empty:!0,allowInReplies:!0,valid:{1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,22:!0,24:!0,25:!0},attr:{unnamed:{req:!0,valid:/^[0-9]+$/},gender:{req:!1,valid:/^(0|1)$/},icon:{req:!1,valid:/^false$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return(!e.domain&&!e.site||!Markup.dbpage)&&!!Markup.tags.race.valid[e.unnamed]},toHtml:function(e){var a=e.unnamed,t=0|e.gender,r=Markup._getDatabaseDomainInfo(e),i=r[0],n=r[1];if(g_races[a]&&g_races[a][n]){var l=g_races[a];return'<a href="'+i+"?race="+a+'"'+(e.icon?"":' class="icontiny"><img src="'+g_staticDataUrl+"/images/wow/icons/tiny/"+g_races.getIcon(a,t)+'.gif"')+Markup._addGlobalAttributes(e)+' align="absmiddle" /> <span class="tinyicontxt">'+Markup._safeHtml(l[n])+"</span></a>"}return'<a href="'+i+"?race="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[14][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_races[a]&&g_races[a][r]?Markup._safeHtml(g_races[a][r]):LANG.types[14][0]+" #"+a}},reveal:{empty:!1,rtrim:!0,ltrim:!0,allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){return!Markup.inBlog||Markup.inBlog>1?["",""]:['<span id="reveal-'+Markup.reveals+'" style="display: none">','</span> <a id="revealtoggle-'+Markup.reveals+'" class="revealtoggle" href="javascript:;" onclick="Markup.toggleReveal('+Markup.reveals+');">(read more)</a>']}},s:{empty:!1,allowInReplies:!0,toHtml:function(e){return["<del"+Markup._addGlobalAttributes(e)+">","</del>"]},fromHtml:function(e){return e.replace(/<del\b[\s\S]*?>([\s\S]*?)<\/del>/gi,"[s]$1[/s]")}},screenshot:{empty:!1,attr:{id:{req:!1,valid:/^[0-9]+$/},url:{req:!1,valid:/\S+/},thumb:{req:!1,valid:/\S+/},size:{req:!1,valid:/^(thumb|resized|normal)$/i},width:{req:!1,valid:/^[0-9]+$/},height:{req:!1,valid:/^[0-9]+$/},float:{req:!1,valid:/^(left|right)$/i},border:{req:!1,valid:/^[0-9]+$/},shadow:{req:!1,valid:/^(true|false)$/}},taglessSkip:!0,allowedClass:MARKUP_CLASS_STAFF,validate:function(e){return!(e.url&&!e.thumb)&&!(!e.id&&!e.url)},toHtml:function(e){var a=[],t=[],r="",i="";if(e.id){r=g_staticUrl+"/uploads/screenshots/normal/"+e.id+".jpg";var n=e.id;e.thumb&&e.thumb.match(/^[0-9]+$/)&&(n=e.thumb,e.thumb=null),i=g_staticUrl+"/uploads/screenshots/"+(e.size?e.size:"thumb")+"/"+n+".jpg"}else e.url&&(r=e.url);e.thumb&&(i=e.thumb);var l=e._contents.replace(/\n/g,"<br />");g_screenshots[Markup.uid]||(g_screenshots[Markup.uid]=[]);var s='<a href="'+r+'" onclick="if(!g_isLeftClick(event)) return; ScreenshotViewer.show({screenshots: \''+Markup.uid+"', pos: "+g_screenshots[Markup.uid].length+'}); return false;"'+Markup._addGlobalAttributes(e)+">";s+='<img src="'+i+'" ',e.size&&e.width&&(s+=' width="'+e.width+'"'),e.size&&e.height&&(s+=' height="'+e.height+'"'),e.border?0==e.border?a.push("no-border"):(a.push("border"),t.push("border-width:"+e.border+"px")):(a.push("content-image"),"true"==e.shadow&&a.push("content-image-shadowed")),e.float&&a.push("markup-float-"+e.float),a.length&&(s+=' class="'+a.join(" ")+'"'),t.length&&(s+=' style="'+t.join(";")+'"'),s+='alt="" ';var o={caption:l,width:e.size?null:e.width,height:e.size?null:e.height,noMarkup:!0};return e.id?o.id=e.id:o.url=e.url,g_screenshots[Markup.uid].push(o),[s+"/></a>"]}},script:{ltrim:!0,rtrim:!0,empty:!1,attr:{src:{req:!1,valid:/^\S+$/}},allowedClass:MARKUP_CLASS_ADMIN,allowedChildren:{"<text>":1},rawText:!0,taglessSkip:!0,toHtml:function(e){return e.src?$.getScript(e.src,function(){$.globalEval(e._contents)}):$.globalEval(e._contents),[""]}},section:{empty:!1,ltrim:!0,rtrim:!0,trim:!0,allowedClass:MARKUP_CLASS_STAFF,attr:{},toHtml:function(e){return['<div class="secheader"><var></var>',"</div>"]}},skill:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},icon:{req:!1,valid:/^false$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1];if(g_skills[a]&&g_skills[a][i]){var n=g_skills[a];return'<a href="'+r+"?skill="+a+'"'+(e.icon?"":' class="icontiny"><img src="'+g_staticDataUrl+"/images/wow/icons/tiny/"+g_skills.getIcon(a)+'.gif"')+Markup._addGlobalAttributes(e)+' align="absmiddle" /> <span class="tinyicontxt">'+Markup._safeHtml(n[i])+"</span></a>"}return'<a href="'+r+"?skill="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[15][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_skills[a]&&g_skills[a][r]?Markup._safeHtml(g_skills[a][r]):LANG.types[15][0]+" #"+a}},sig:{empty:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/}},allowedClass:MARKUP_CLASS_PREMIUM,allowedModes:{signature:1},toHtml:function(e){}},small:{empty:!1,toHtml:function(e){return["<small"+Markup._addGlobalAttributes(e)+">","</small>"]},fromHtml:function(e){return e.replace(/<small\b[\s\S]*?>([\s\S]*?)<\/small>/gi,"[small]$1[/small]")}},sound:{empty:!0,attr:{unnamed:{req:!1,valid:/^[0-9]+$/},src:{req:!1,valid:/\S+/},title:{req:!1,valid:/\S+/},type:{req:!1,valid:/\S+/},src2:{req:!1,valid:/\S+/},type2:{req:!1,valid:/\S+/},domain:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return!!e.unnamed||!!e.src},toHtml:function(e){var a,t,r,i,n,l,s=Markup._getDatabaseDomainInfo(e),o=s[0];if(e.unnamed){if(!(e.unnamed in g_sounds))return"";if(!g_sounds[e.unnamed].hasOwnProperty("files"))return"";if(0==g_sounds[e.unnamed].files.length)return"";if(!g_sounds[e.unnamed].files[0].hasOwnProperty("type"))return"";a=g_sounds[e.unnamed].files[0].type,t=g_sounds[e.unnamed].files[0].url,r=g_sounds[e.unnamed].name?g_sounds[e.unnamed].name:g_sounds[e.unnamed].files[0].title,i=o+"?sound="+e.unnamed}else{if(Markup.allow<MARKUP_CLASS_STAFF)return"";if(t=e.src,r=e.title?e.title:"(Unknown)",e.hasOwnProperty("type"))a=e.type;else switch(e.src.toLowerCase().substr(-4)){case".mp3":a="audio/mpeg";break;case".ogg":a='audio/ogg; codecs="vorbis"'}if(e.src2)if(n=e.src2,e.hasOwnProperty("type2"))l=e.type2;else switch(e.src2.toLowerCase().substr(-4)){case".mp3":l="audio/mpeg";break;case".ogg":l='audio/ogg; codecs="vorbis"'}}var u='<audio preload="none" controls="true"'+Markup._addGlobalAttributes(e);return e.unnamed&&(u+=' rel="sound='+e.unnamed+'"'),u+=">",/^(https?:)?\/\//.test(t)||(t=g_staticDataUrl+"/wowsounds"+t),u+='<source src="'+t+'"',a&&(u+=' type="'+a.replace(/"/g,"&quot;")+'"'),u+=">",n&&(u+='<source src="'+n+'"',l&&(u+=' type="'+l.replace(/"/g,"&quot;")+'"'),u+=">"),u+="</audio>",i&&(u='<div class="audiomarkup">'+u+'<br><a href="'+i+'">'+r+"</a></div>"),u},fromHtml:function(e){var a=e.match(/<audio [^>]*\brel="sound=(\d+)/);return a?"[sound="+a[1]+"]":e.replace(/<audio\b[\s\S]*?><source\b[\s\S]*\bsrc="([^"]*?)"[\s\S]*?<\/audio>/gi,'[sound src="$1"]')}},span:{empty:!1,attr:{class:{req:!1,valid:/^[a-z0-9 _-]+$/i},style:{req:!1,valid:/^[^<>]+$/},unnamed:{req:!1,valid:/^(hidden|invisible)$/},tooltip:{req:!1,valid:/\S+/},tooltip2:{req:!1,valid:/\S+/}},allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){var a="<span"+Markup._addGlobalAttributes(e),t=[];return"hidden"==e.unnamed?t.push("display: none"):"invisible"==e.unnamed&&t.push("visibility: hidden"),t.length>0&&(a+=' style="'+t.join(";")+'"'),e.tooltip&&Markup.tooltipTags[e.tooltip]&&(a+=" onmouseover=\"$WH.Tooltip.showAtCursor(event, Markup.tooltipTags['"+e.tooltip+"'], 0, 0, "+(Markup.tooltipBare[e.tooltip]?"null":"'q'")+", "+(e.tooltip2&&Markup.tooltipTags[e.tooltip2]?"Markup.tooltipTags['"+e.tooltip2+"']":"null")+')" onmousemove="$WH.Tooltip.cursorUpdate(event)" onmouseout="$WH.Tooltip.hide()"'),a+=">",[a,"</span>"]}},spell:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},diff:{req:!1,valid:/^[0-9]+$/},icon:{req:!1,valid:/^false$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang},buff:{req:!1,valid:/^true$/},tempname:{req:!1}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1],n=[],l=null;if(e.buff&&n.push("buff"),e.diff&&n.push("diff="+e.diff),e.tempname&&(l=e.tempname),g_spells[a]&&g_spells[a][i]){var s=g_spells[a];return'<a href="'+r+"?spell="+a+'"'+(n.length?' rel="'+n.join("&")+'"':"")+(e.icon?"":' class="icontiny"><img src="'+g_staticDataUrl+"/images/wow/icons/tiny/"+s.icon.toLowerCase()+'.gif"')+Markup._addGlobalAttributes(e)+' align="absmiddle" /> <span class="tinyicontxt">'+Markup._safeHtml(s[i])+"</span></a>"}return'<a href="'+r+"?spell="+a+'"'+(n.length?' rel="'+n.join("&")+'"':"")+">"+(l||"("+LANG.types[6][0]+" #"+a+")")+"</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_spells[a]&&g_spells[a][r]?Markup._safeHtml(g_spells[a][r]):LANG.types[6][0]+" #"+a}},spoiler:{block:!0,empty:!1,rtrim:!0,ltrim:!0,itrim:!0,toHtml:function(e){return['<div class="pad"></div><small><b>'+LANG.markup_spoil+"</b></small><div"+Markup._addGlobalAttributes(e)+' class="spoiler">',"</div>"]}},statistic:{empty:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},icon:{req:!1,valid:/^false$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1];if(g_achievements[a]&&g_achievements[a][i]){var n=g_achievements[a];return'<a href="'+r+"?achievement="+a+'"'+(e.icon?"":' class="icontiny"><img src="'+g_staticDataUrl+"/images/wow/icons/tiny/"+n.icon.toLowerCase()+'.gif"')+Markup._addGlobalAttributes(e)+' align="absmiddle" /> <span class="tinyicontxt">'+Markup._safeHtml(n[i])+"</span></a>"}return'<a href="'+r+"?achievement="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[10][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=(t[0],t[1]);return g_achievements[a]&&g_achievements[a][r]?Markup._safeHtml(g_achievements[a][r]):LANG.types[10][0]+" #"+a}},style:{ltrim:!0,rtrim:!0,empty:!1,allowedClass:MARKUP_CLASS_ADMIN,allowedChildren:{"<text>":1},rawText:!0,taglessSkip:!0,toHtml:function(e){return g_addCss(e._contents),[""]}},sub:{empty:!1,toHtml:function(e){return["<sub"+Markup._addGlobalAttributes(e)+">","</sub>"]},fromHtml:function(e){return e.replace(/<sub\b[\s\S]*?>([\s\S]*?)<\/sub>/gi,"[sub]$1[/sub]")}},sup:{empty:!1,toHtml:function(e){return["<sup"+Markup._addGlobalAttributes(e)+">","</sup>"]},fromHtml:function(e){return e.replace(/<sup\b[\s\S]*?>([\s\S]*?)<\/sup>/gi,"[sup]$1[/sup]")}},tabs:{block:!0,empty:!1,ltrim:!0,rtrim:!0,itrim:!0,allowedClass:MARKUP_CLASS_STAFF,allowedChildren:{tab:1},attr:{name:{req:!0,valid:/\S+/},width:{req:!1,valid:/^[0-9]+(px|em|\%)$/}},toHtml:function(e){e.id=g_urlize(e.name);var a=Markup.preview,t='<div id="dsf67g4d-'+e.id+(a?"-preview":"")+'"></div>';t+="<div",e.width&&(t+=' style="width: '+e.width+'"'),t+=">",t+='<div class="tabbed-contents">';for(var r=e._contents,i=0;i<r.length;++i){var n=r[i];t+='<div id="tab-'+e.id+"-"+n.id+'" style="display: none">',t+=n.content,t+="</div>"}return t+="</div>",t+="</div>",setTimeout(Markup.createTabs.bind(null,e,r,a?"preview":""),100),[t]}},tab:{block:!0,empty:!1,ltrim:!0,rtrim:!0,itrim:!0,allowedClass:MARKUP_CLASS_STAFF,allowedParents:{tabs:1},attr:{name:{req:!0,valid:/[\S ]+/},icon:{req:!1,valid:/\S+/}},toHtml:function(e){return e.id=g_urlize(e.name),e.name=$WH.str_replace(e.name,"_"," "),void 0!==e.class&&(e.class=$WH.str_replace(e.class,"_"," ")),[{content:e._contents,id:e.id,name:e.name,icon:e.icon,class:e.class}]}},table:{empty:!1,ltrim:!0,rtrim:!0,itrim:!0,allowedChildren:{tr:1},attr:{border:{req:!1,valid:/^[0-9]+$/},cellspacing:{req:!1,valid:/^[0-9]+$/},cellpadding:{req:!1,valid:/^[0-9]+$/},width:{req:!1,valid:/^[0-9]+(px|em|\%)$/}},toHtml:function(e){var a="<table"+Markup._addGlobalAttributes(e);return void 0!=e.border&&(a+=' border="'+e.border+'"'),void 0!=e.cellspacing&&(a+=' cellspacing="'+e.cellspacing+'"'),void 0!=e.cellpadding&&(a+=' cellpadding="'+e.cellpadding+'"'),void 0!=e.width&&(a+=' style="width: '+e.width+'"'),a+="><tbody>",[a,"</tbody></table>"]},fromHtml:function(e,a){a=a||0;var t;if(t=Markup.matchOuterTags(e,"<table\\b[\\s\\S]*?>","</table>","g"))for(var r=0;r<t.length;++r){var i=t[r][1].match(/border[:="]+\s*([0-9]+)/i),n=t[r][1].match(/width[:="]+\s*([0-9]+(%|em|px)?)/i),l=t[r][1].match(/cellspacing="([\s\S]+?)"/i),s=t[r][1].match(/cellpadding="([\s\S]+?)"/i);e=e.replace(t[r][1]+t[r][0]+t[r][2],"\n"+Array(a+1).join("\t")+"[table"+(i?" border="+i[1]:"")+(n?" width="+n[1]+(n[2]?"":"px"):"")+(l?" cellspacing="+l[1]:"")+(s?" cellpadding="+s[1]:"")+"]"+Markup.tags.table.fromHtml(t[r][0],a+1)+"\n"+Array(a+1).join("\t")+"[/table]")}return e}},tr:{empty:!1,itrim:!0,allowedChildren:{td:1},allowedParents:{table:1},toHtml:function(e){return["<tr"+Markup._addGlobalAttributes(e)+">","</tr>"]},fromHtml:function(e,a){a=a||0;var t;if(t=Markup.matchOuterTags(e,"<tr\\b[\\s\\S]*?>","</tr>","g"))for(var r=0;r<t.length;++r)e=e.replace(t[r][1]+t[r][0]+t[r][2],"\n\t"+Array(a+1).join("\t")+"[tr]"+Markup.tags.tr.fromHtml(t[r][0],a+1)+"\n"+Array(a+1).join("\t")+"[/tr]");return e}},td:{empty:!1,itrim:!0,allowedParents:{tr:1},attr:{unnamed:{req:!1,valid:/^header$/},align:{req:!1,valid:/^(right|left|center|justify)$/i},valign:{req:!1,valid:/^(top|middle|bottom|baseline)$/i},colspan:{req:!1,valid:/^[0-9]+$/},rowspan:{req:!1,valid:/^[0-9]+$/},width:{req:!1,valid:/^[0-9]+(px|em|\%)$/}},toHtml:function(e){var a="<"+(e.unnamed?"th":"td")+Markup._addGlobalAttributes(e);return void 0!=e.align&&(a+=' align="'+e.align+'"'),void 0!=e.valign&&(a+=' valign="'+e.valign+'"'),void 0!=e.colspan&&(a+=' colspan="'+e.colspan+'"'),void 0!=e.rowspan&&(a+=' rowspan="'+e.rowspan+'"'),void 0!=e.width&&(a+=' style="width: '+e.width+'"'),a+=">",[a,"</"+(e.unnamed?"th":"td")+">"]},fromHtml:function(e,a){a=a||0;for(var t,r=["td","th"],i=0;i<r.length;++i)if(t=Markup.matchOuterTags(e,"<"+r[i]+"\\b[\\s\\S]*?>","</"+r[i]+">","g"))for(var n=0;n<t.length;++n){var l=t[n][1].match(/width[:="]+\s*([0-9]+(%|em|px)?)/i),s=t[n][1].match(/\balign="([\s\S]+?)"/i),o=t[n][1].match(/valign="([\s\S]+?)"/i),u=t[n][1].match(/colspan="([\s\S]+?)"/i),d=t[n][1].match(/rowspan="([\s\S]+?)"/i);e=e.replace(t[n][1]+t[n][0]+t[n][2],"\n\t\t"+Array(a+1).join("\t")+"[td"+("th"==r[i]?"=header":"")+(l?" width="+l[1]+(l[2]?"":"px"):"")+(s?" align="+s[1]:"")+(o?" valign="+o[1]:"")+(u?" colspan="+u[1]:"")+(d?" rowspan="+d[1]:"")+"]"+Markup.tags.td.fromHtml(t[n][0],a+1)+"[/td]")}return e}},time:{empty:!0,count:0,attr:{until:{req:!1,valid:/^\d+$/},since:{req:!1,valid:/^\d+$/},server:{req:!1,valid:/^true$/}},validate:function(e){return!(!e.until&&!e.since)},toHtml:function(e){var a=Markup.tags.time.count++,t='<span title="'+new Date(1e3*(e.until?e.until:e.since)).toLocaleString()+'" id="markupTime'+a+'">'+Markup.tags.time.getTime(e)+"</span>";return setInterval(Markup.tags.time.updateTime.bind(null,a,e),5e3),t},getTime:function(e){var a;a=e.server?g_serverTime.getTime()/1e3:(new Date).getTime()/1e3;var t=0;return t=e.until?e.until-a:a-e.since,t>0?g_formatTimeElapsed(t):"0 "+LANG.timeunitspl[6]},updateTime:function(e,a){var t=$WH.ge("markupTime"+e);t&&(t.firstChild.nodeValue=Markup.tags.time.getTime(a))}},toc:{block:!0,post:!0,trim:!0,ltrim:!0,rtrim:!0,collect:{h2:1,h3:1},exclude:{tabs:{h2:1,h3:1},minibox:{h2:1,h3:1}},allowedClass:MARKUP_CLASS_STAFF,attr:{h3:{req:!1,valid:/^false$/}},postHtml:function(e,a){var t="<h3",r=[];e.first&&r.push("first"),e.last&&r.push("last"),r.length>0&&(t+=' class="'+r.join(" ")+'"'),t+=Markup._addGlobalAttributes(e)+">"+LANG.markup_toc+"</h3><ul>";var i="",n=1,l="false"!=e.h3,s=[];for(var o in a.h2)s.push(a.h2[o]);for(var o in a.h3)s.push(a.h3[o]);s.sort(function(e,a){return e.offset-a.offset});for(var u in s)o=s[u],"h2"==o.name&&"false"!=o.attr.toc&&("h3"==i&&(t+="</ul>",n--),t+="<li><b><a href='#"+(o.attr.id?g_urlize(o.attr.id):g_urlize(o.attr._textContents))+"'>"+o.attr._textContents+"</a></b></li>",i="h2"),"h3"!=o.name||!l||"false"==o.attr.toc||""==i&&0!=a.h2.length||("h2"==i&&(t+="<ul>",n++),t+="<li><b><a href='#"+(o.attr.id?g_urlize(o.attr.id):g_urlize(o.attr._textContents))+"'>"+o.attr._textContents+"</a></b></li>",i="h3");for(var u=0;u<n;u++)t+="</ul>";return t}},toggler:{empty:!1,attr:{id:{req:!0,valid:/^[a-z0-9_-]+$/i},unnamed:{req:!1,valid:/^hidden$/i}},allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){return['<a href="javascript:;" class="disclosure-'+(e.unnamed?"off":"on")+'" onclick="return g_disclose($WH.ge(\''+e.id+"'), this)\">","</a>"]}},tooltip:{empty:!1,attr:{unnamed:{req:!1,valid:/\S+/},name:{req:!1,valid:/\S+/},bare:{req:!1,valid:/^true$/i},label:{req:!1,valid:/[\S ]+/}},taglessSkip:!0,allowedClass:MARKUP_CLASS_STAFF,validate:function(e){return!(!e.unnamed&&!e.name)},toHtml:function(e){return e.unnamed?['<span class="tip" onmouseover="$WH.Tooltip.showAtCursor(event, LANG[\''+e.unnamed+'\'], 0, 0, \'q\')" onmousemove="$WH.Tooltip.cursorUpdate(event)" onmouseout="$WH.Tooltip.hide()">',"</span>"]:(Markup.tooltipTags[e.name]=(e.label?'<table><tr><td class="q0" style="width: 300px"><small>'+e.label+"</small></td></tr></table>":"")+e._contents,e.bare&&(Markup.tooltipBare[e.name]=!0),[""])}},u:{empty:!1,allowInReplies:!0,toHtml:function(e){return["<ins"+Markup._addGlobalAttributes(e)+">","</ins>"]},fromHtml:function(e){return e.replace(/<(ins|u)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[u]$2[/u]")}},ul:{block:!0,empty:!1,ltrim:!0,rtrim:!0,itrim:!0,allowedChildren:{li:1},toHtml:function(e){var a="<ul",t=[];return e.first&&t.push("first"),e.last&&t.push("last"),t.length>0&&(a+=' class="'+t.join(" ")+'"'),a+=Markup._addGlobalAttributes(e)+">",[a,"</ul>"]},fromHtml:function(e,a){a=a||0;var t;if(t=Markup.matchOuterTags(e,"<ul\\b[\\s\\S]*?>","</ul>","g"))for(var r=0;r<t.length;++r)e=e.replace(t[r][1]+t[r][0]+t[r][2],"\n"+Array(a+1).join("\t")+"[ul]"+Markup.tags.ul.fromHtml(t[r][0],a+1)+"\n"+Array(a+1).join("\t")+"[/ul]");return e}},url:{allowedClass:MARKUP_CLASS_USER,allowInReplies:!0,empty:!1,helpText:"[url=http://www.google.com]"+LANG.markup_url+"[/url]",attr:{unnamed:{req:!1,valid:/\S+/},rel:{req:!1,valid:/(item|quest|spell|achievement|event|npc|object|itemset|currency)=([0-9]+)/},onclick:{req:!1,valid:/[\S ]+/},style:{req:!1,valid:/^[^"<>]+$/},tooltip:{req:!1,valid:/\S+/},tooltip2:{req:!1,valid:/\S+/},newwindow:{req:!1,valid:/^true$/}},validate:function(e){if(e.onclick&&Markup.allow<Markup.CLASS_ADMIN)return!1;if(e.tooltip&&Markup.allow<Markup.CLASS_STAFF)return!1;return!(e.unnamed&&/^(mailto:|irc:)/i.test(e.unnamed.trim())&&Markup.allow<Markup.CLASS_STAFF)&&(!e.unnamed||!/^(javascript:)/i.test(e.unnamed.trim()))},toHtml:function(e){var a;if(e.unnamed){if(a=e.unnamed,a=a.replace(/&amp;/,"&"),a.match(/^([^:\\.\/]+):/i)||"/"==a.charAt(0)||"#"==a.charAt(0)||(a="/"+a),Markup._isUrlSafe(a,!0)){var t="<a"+Markup._addGlobalAttributes(e)+' href="'+Markup._fixUrl(a)+'"';return(Markup._isUrlExternal(a)||e.newwindow)&&(t+=' target="_blank"'),e.rel&&(t+=' rel="'+e.rel+'"'),e.onclick&&(t+=' onclick="'+e.onclick+'"'),e.tooltip&&Markup.tooltipTags[e.tooltip]&&(t+=" onmouseover=\"$WH.Tooltip.showAtCursor(event, Markup.tooltipTags['"+e.tooltip+"'], 0, 0, "+(Markup.tooltipBare[e.tooltip]?"null":"'q'")+", "+(e.tooltip2&&Markup.tooltipTags[e.tooltip2]?"Markup.tooltipTags['"+e.tooltip2+"']":"null")+')" onmousemove="$WH.Tooltip.cursorUpdate(event)" onmouseout="$WH.Tooltip.hide()"'),e.style&&Markup.allow>=Markup.CLASS_STAFF&&(t+=' style="'+e.style+'"'),t+=">",[t,"</a>"]}return["",""]}if(a=e._textContents,a=a.replace(/&amp;/,"&"),Markup._isUrlSafe(a)){var t="<a"+Markup._addGlobalAttributes(e)+' href="'+Markup._fixUrl(a)+'"';return Markup._isUrlExternal(a)&&(t+=' target="_blank"'),e.rel&&(t+=' rel="'+e.rel+'"'),e.onclick&&(t+=' onclick="'+e.onclick+'"'),t+=">",[t+a+"</a>"]}return["",""]},fromHtml:function(e){return e.replace(/<a\b[\s\S]*?href=\"(.+?)\"[\s\S]*?>([\s\S]*?)<\/a>/gi,"[url=$1]$2[/url]")}},video:{empty:!0,attr:{id:{req:!0,valid:/^[0-9]+$/},unnamed:{req:!1,valid:/^embed$/i},float:{req:!1,valid:/^(left|right)$/i},shadow:{req:!1,valid:/^(true|false)$/},border:{req:!1,valid:/^[0-9]+$/}},ltrim:!0,rtrim:!0,allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){if(g_videos[e.id]){var a="",t=g_videos[e.id],r=[],i=[];return e.unnamed?1==t.videoType&&(a+=Markup.toHtml("[youtube="+t.videoId+"]",{skipReset:!0})):(g_videos[Markup.uid]||(g_videos[Markup.uid]=[]),a+='<div style="position: relative; display: -moz-inline-stack; display: inline-block; zoom: 1; *display: inline"><a href="'+$WH.sprintf(vi_siteurls[t.videoType],t.videoId)+'" onclick="if(!g_isLeftClick(event)) return; VideoViewer.show({videos: \''+Markup.uid+"', pos: "+g_videos[Markup.uid].length+'}); return false;"'+Markup._addGlobalAttributes(e)+">",a+='<img src="'+$WH.sprintf(vi_thumbnails[t.videoType],t.videoId)+'" ',e.border?0==e.border?r.push("no-border"):(r.push("border"),i.push("border-width:"+e.border+"px")):(r.push("content-image"),"true"==e.shadow&&r.push("content-image-shadowed")),e.float&&r.push("markup-float-"+e.float),r.length&&(a+='class="'+r.join(" ")+'" '),i.length&&(a+=' style="'+i.join(";")+'"'),t.hasCaption&&(a+='alt="'+Markup.removeTags(t.caption,{mode:Markup.MODE_SIGNATURE,skipReset:!0})+'" '),a+='/><img src="'+g_staticDataUrl+'/images/icons/play-sm.png" style="opacity: 0.6; filter:alpha(opacity=60); position: absolute; width: 48px; height: 48px; top: 23px; left: 38px" />',a+="</a></div>",g_videos[Markup.uid].push($WH.dO(t))),a}return"<b>Video #"+e.id+"</b>"}},visitedpage:{empty:!1,attr:{unnamed:{req:!0,valid:/^[0-9]+$/}},allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){return $.post("/visited-page",{id:e.unnamed},function(){AchievementCheck()}),""}},wowheadresponse:{block:!0,empty:!1,rtrim:!0,ltrim:!0,
itrim:!0,attr:{unnamed:{req:!0,valid:/[\S ]+/},roles:{req:!0,valid:/[0-9]+/}},allowedModes:{article:1,quickfacts:1,comment:1},allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){var a="<div"+Markup._addGlobalAttributes(e);a+=' class="quote ',e.first&&(a+="firstmargin "),e.last;var t=e.unnamed.trim();if(t.length<=0)return["",""];var r="";return r=e.roles&U_GROUP_ADMIN?"comment-blue":"comment-green",g_customColors[t]&&(r="comment-"+g_customColors[t]),a+=r+'"><small class="icon-wowhead"><b class="'+r+'"><a href="?user='+t+'">'+t+"</a></b> "+LANG.markup_said+'</small><div class="pad"></div>',[a,"</div>"]}},youtube:{empty:!0,attr:{unnamed:{req:!0,valid:/\S+/},width:{req:!1,valid:/^[0-9]+$/},height:{req:!1,valid:/^[0-9]+$/},autoplay:{req:!1,valid:/^true$/}},allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){var a=e.width?e.width:640,t=e.height?e.height:385;window.outerWidth&&window.outerWidth-20<a&&(a=window.outerWidth-20,t=Math.floor(.6015625*a));var r={height:t,width:a,videoId:e.unnamed,playerVars:{autoplay:e.autoplay?1:0}};if(0==Markup.youtube.players.length){var i;i=$WH.isset("onYouTubeIframeAPIReady")&&"function"==typeof window.onYouTubeIframeAPIReady?window.onYouTubeIframeAPIReady:function(){},window.onYouTubeIframeAPIReady=function(){Markup.youtube.APIReady(),i()},$WH.isset("YT")||(window.YT={},$WH.g_ajaxIshRequest("https://www.youtube.com/iframe_api",!0))}var n=Markup.youtube.players.length,l={id:n,containerId:"yt-markup-container-"+n,yt:r,loaded:!1};return Markup.youtube.players.push(l),(Markup.youtube.APIIsReady||$WH.isset("YT")&&YT.hasOwnProperty("Player"))&&void 0===Markup.youtube.readyTimeout&&(Markup.youtube.readyTimeout=window.setTimeout(Markup.youtube.APIReady,10)),'<div class="yt-markup-container" id="yt-markup-container-'+n+'" style="width: '+a+"px; height: "+t+'px;"></div>'},fromHtml:function(e){var a;if(a=e.match(/<iframe\b[\s\S]*?src="[\s\S]*?youtube\.com\/embed\/[\s\S]*?"[\s\S]*?><\/iframe>/gi))for(var t=0;t<a.length;++t){var r=a[t].match(/src="[\s\S]*?youtube\.com\/embed\/([\s\S]*?)"/i),i=a[t].match(/width[:="]+\s*([0-9]+)/i),n=a[t].match(/height[:="]+\s*([0-9]+)/i);a[t].match(/border[:="]+\s*([0-9]+)/i);e=e.replace(a[t],"[youtube="+r[1]+(i?" width="+i[1]:"")+(n?" height="+n[1]:"")+"]")}return e}},center:{empty:!1,allowInReplies:!1,allowedClass:MARKUP_CLASS_STAFF,toHtml:function(e){return["<center>","</center>"]},fromHtml:function(e){return e.replace(/<center>([\s\S]+?)<\/center>/gi,"[pad][div align=center]$1[/div][pad]")}},title:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1];return g_titles[a]&&g_titles[a][i]?'<a href="'+r+"?title="+a+'"'+Markup._addGlobalAttributes(e)+">"+Markup._safeHtml(g_titles[a][i])+"</a>":'<a href="'+r+"?title="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[11][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_titles[a]&&g_titles[a][r]?Markup._safeHtml(g_titles[a][r]):LANG.types[11][0]+" #"+a}},zone:{empty:!0,allowInReplies:!0,attr:{unnamed:{req:!0,valid:/^[0-9]+$/},domain:{req:!1,valid:MarkupDomainRegexMap.lang},site:{req:!1,valid:MarkupDomainRegexMap.lang}},validate:function(e){return!e.domain&&!e.site||!Markup.dbpage},toHtml:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[0],i=t[1];return g_gatheredzones[a]&&g_gatheredzones[a][i]?'<a href="'+r+"?zone="+a+'"'+Markup._addGlobalAttributes(e)+">"+Markup._safeHtml(g_gatheredzones[a][i])+"</a>":'<a href="'+r+"?zone="+a+'"'+Markup._addGlobalAttributes(e)+">("+LANG.types[7][0]+" #"+a+")</a>"},toText:function(e){var a=e.unnamed,t=Markup._getDatabaseDomainInfo(e),r=t[1];return g_gatheredzones[a]&&g_gatheredzones[a][r]?Markup._safeHtml(g_gatheredzones[a][r]):LANG.types[7][0]+" #"+a}}},_addGlobalAttributes:function(e){var a="";return Markup.allow<Markup.CLASS_STAFF?a:(e.id&&(a+=' id="'+e.id+'"'),e.title&&(a+=' title="'+Markup._safeQuotes(e.title)+'"'),e.class&&(a+=' class="'+e.class+'"'),e.style&&(a+=' style="'+e.style+'"'),e["data-highlight"]&&(a+=' data-highlight="'+e["data-highlight"]+'"'),a)},_generateTagDocs:function(e,a){var t=Markup.tags[e];if(!t)return"";if(a){if(t.allowedClass&&t.allowedClass>a||!t.helpText&&(t.empty||t.allowedParents||t.allowedChildren||!LANG["markup_"+e]))return"";if(t.helpText&&"function"==typeof t.helpText)var r=t.helpText();else if(t.helpText&&"string"==typeof t.helpText)var r=t.helpText;else var r="["+e+"]"+LANG["markup_"+e].toLowerCase()+"[/"+e+"]";return"<tr><td><pre>"+r+"</pre></td><td>"+Markup.toHtml(r,{skipReset:!0})+"</td></tr>"}var r='<div><h3 class="first">Tag: ['+Markup._safeHtml(e)+"]</h3>";if(r+='<table class="grid">',t.attr){r+='<tr><td align="right" width="200">Attributes:</td><td>';for(var i in t.attr)r+='<div style="margin: 5px; display: inline-block"><table><tr><th style="background-color: #242424; font-weight: bolder" colspan="2">',r+="unnamed"==i?"Self (["+e+"=???])":i,r+="</th></tr>",r+='<tr><td align="right">Required:</td><td>'+(t.attr[i].req?"Yes":"No")+"</td></tr>",r+='<tr><td align="right">Valid:</td><td>'+(t.attr[i].valid?Markup._safeHtml(t.attr[i].valid.toString()):"--")+"</td></tr></table></div>";r+="</td></tr>"}if(r+='<tr><td align="right" width="200">Has closing tag:</td><td>'+(t.empty?"No":"Yes")+"</td></tr>",r+='<tr><td align="right">Required group:</td><td>',t.allowedClass==MARKUP_CLASS_ADMIN?r+="Administrator":t.allowedClass==MARKUP_CLASS_STAFF?r+="Staff":t.allowedClass==MARKUP_CLASS_PREMIUM?r+="Premium":t.allowedClass&&t.allowedClass!=MARKUP_CLASS_PENDING?r+="Not pending":r+="None",r+="</td></tr>",t.allowedChildren){r+='<tr><td align="right">Allowed children:</td><td>';for(var n in t.allowedChildren)r+=Markup._safeHtml(n)+"<br />";r+="</td></tr>"}if(t.allowedParents){r+='<tr><td align="right">Allowed parents:</td><td>';for(var n in t.allowedParents)r+=Markup._safeHtml(n)+"<br />";r+="</td></tr>"}if(t.presets){r+='<tr><td align="right">Preset values:</td><td><table>';for(var l in t.presets)r+='<tr><td align="right">'+l+"</td><td>"+Markup._safeHtml(t.presets[l])+"</td></tr>";r+="</table></td></tr>"}return t.trim&&(r+='<tr><td colspan="2">Trim whitespace</td></tr>'),t.ltrim&&(r+='<tr><td colspan="2">Trim preceding whitespace</td></tr>'),t.rtrim&&(r+='<tr><td colspan="2">Trim following whitespace</td></tr>'),t.itrim&&(r+='<tr><td colspan="2">Trim whitespace around interior content</td></tr>'),t.block&&(r+='<tr><td colspan="2">Automatically remove top padding if not the first item</td></tr>'),r+="</table></div>"},_init:function(){if(!this.inited){var e=[],a=[],t=[];for(var r in Markup.tags){if(Markup.tags[r].block&&(this.firstTags[r]=!0),Markup.tags[r].exclude)for(var i in Markup.tags[r].exclude)this.excludeTags[i]||(this.excludeTags[i]={}),this.excludeTags[i][r]=Markup.tags[r].exclude[i];Markup.tags[r].post&&this.postTags.push(r),Markup.tags[r].trim&&t.push(r),Markup.tags[r].ltrim&&e.push(r),Markup.tags[r].rtrim&&a.push(r)}e.length>0&&(this.ltrimRegex=new RegExp("\\s*\\[("+e.join("|")+")([^a-z0-9]+.*)?]","ig")),a.length>0&&(this.rtrimRegex=new RegExp("\\[/("+a.join("|")+")\\]\\s*","ig")),t.length>0&&(this.trimRegex=new RegExp("\\s*\\[("+t.join("|")+")([^\\[]*)?\\]\\s*","ig")),this.inited=!0,$(function(){$(document).delegate("[data-highlight]","mouseenter",function(){var e=$(this).attr("data-highlight").split(":");if(2==e.length){var a=$("#"+e[0]).get(0),t=parseInt(e[1]),r=$(a).val();if(a&&t&&r){var i=$(a).val(r.substr(0,t))[0].scrollHeight;$(a).val(r).animate({scrollTop:i},250),a.selectionStart=t,a.selectionEnd=t}}})})}},_safeJsString:function(e){return e.replace(/'/g,"'")},_safeQuotes:function(e){return e.replace('"','"').replace("'","'")},_safeHtml:function(e){var a=["nbsp","ndash"];return e=e.replace(/&/g,"&amp;"),a.length>0&&(e=e.replace(new RegExp("&amp;("+a.join("|")+");","g"),"&$1;")),e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},_preText:function(e){return e=Markup._safeHtml(e),e=e.replace(/\n/g,"<br />")},_getDatabaseDomainInfo:function(e){var a="",t=Markup.nameCol,r=!1;return e.domain?r=e.domain:e.site?r=e.site:Markup.defaultSource&&(r=MarkupSourceMap[Markup.defaultSource]),r?("beta"==r&&(r="mop"),a="http://"+r+".wowhead.com",t="name_"+Markup.domainToLocale[r]):-1!=location.href.indexOf("wowheadnews.com")&&(a="http://www.wowhead.com"),[a,t,r]},_isUrlSafe:function(e,a){if(!e)return!0;if("javascript:;"==e)return!0;var t=e.match(/^([^:\\.\/]+):/i);if(t&&t[1]){var r=t[1];return"http"==r||"https"==r||(!(!a||"mailto"!=r&&"irc"!=r)||"mailto"!=r&&-1==e.indexOf("://"))}return!0},_fixUrl:function(e){if(!e)return"";var a=e.charAt(0);return"/"!=a&&"?"!=a||(e=e.replace(/^[\/\?]+/,""),e="?"+e),e},_isUrlExternal:function(e){return!!e&&g_isExternalUrl(e)},_nodeSearch:function(e,a,t){if(t||(t=0),!(t>=3))return e.name==a||(e.parent?Markup._nodeSearch(e.parent,a,t+1):void 0)},_parse:function(e,a){if(Markup.nameCol="name_"+Locale.getName(),a&&a.locale?Markup.nameCol="name_"+Markup.domainToLocale[a.locale]:$WH.isset("g_beta")&&g_beta?Markup.nameCol="name_beta":$WH.isset("g_ptr")&&g_ptr?Markup.nameCol="name_ptr":$WH.isset("g_old")&&g_old&&(Markup.nameCol="name_old"),e||(e=""),e=e.replace(/\r/g,""),a||(a={}),a.skipReset||(Markup.uid=a.uid||"abc",Markup.root=a.root,Markup.preview=a.preview||!1,Markup.dbpage=a.dbpage||!1,Markup.defaultSource=!1,"abc"!=Markup.uid&&(g_screenshots[Markup.uid]=[])),a.roles&&a.roles&(U_GROUP_ADMIN|U_GROUP_EDITOR|U_GROUP_MOD|U_GROUP_BUREAU|U_GROUP_DEV|U_GROUP_BLOGGER)&&a.mode!=Markup.MODE_SIGNATURE&&(a.mode=Markup.MODE_ARTICLE),Markup.mode=a.mode||Markup.MODE_ARTICLE,Markup.allow=a.allow||Markup.CLASS_STAFF,Markup.inBlog=a.inBlog?a.inBlog:0,a.stopAtBreak){var t=e.indexOf("[break]");-1!=t&&(e=e.substring(0,t))}else e=e.replace("[break]","");var r=new MarkupTree;if(e=e.trim(),this.postTags.length)for(var i in this.postTags){var n=this.postTags[i];if(-1!=e.indexOf("["+n)&&(!Markup.tags[n].allowedModes||void 0!=Markup.tags[n].allowedModes[MarkupModeMap[a.mode]]))for(var l in Markup.tags[n].collect)this.collectTags[l]=!0}e=e.replace(/\n(\s*)\n/g,"\n\n");for(var s=e.length,o=0,u=0,d=-1,p=-1,m=!0,c=!1,g=function(e){var a,t,r;if('"'==e.charAt(0)||"'"==e.charAt(0)){a=e.charAt(0);var i=e.indexOf(a,1);if(i>-1)return r=e.substring(1,i),e=e.substring(i+1).trim(),{value:Markup._safeHtml(r),str:e}}return t=e.indexOf(" "),t>-1?(r=e.substring(0,t),e=e.substring(t+1).trim()):(r=e,e=""),{value:r,str:e}},f=/^\s*[a-z0-9]+\s*=/;u<s;){d=e.indexOf("[",u),d>-1?(u=d+1,d>0&&"\\"==e.charAt(d-1)?(m=!1,d=-1):p=e.indexOf("]",u)):u=s;var h,v={};if(a.highlight&&$(a.highlight)&&(v["data-highlight"]=a.highlight+":"+d),p>-1){var M=e.substring(d+1,p);if("/"==M.charAt(0)&&(c=!0,h=M.substr(1).trim().toLowerCase()),c)void 0==Markup.tags[h]&&(m=!1);else{var _=M.indexOf(" "),k=M.indexOf("=");if((k<_||-1==_)&&k>-1){h=M.substring(0,k).toLowerCase(),M=M.substring(k+1).trim();var b=g(M);M=b.str,void 0==Markup.tags[h]||void 0==Markup.tags[h].attr||void 0==Markup.tags[h].attr.unnamed?m=!1:v.unnamed=b.value}else _>-1?(h=M.substring(0,_).toLowerCase(),M=M.substring(_+1).trim(),-1==M.indexOf("=")&&(void 0==Markup.tags[h]||void 0==Markup.tags[h].attr||void 0==Markup.tags[h].attr.unnamed?m=!1:v.unnamed=M,M="")):(h=M.toLowerCase(),M="");if(void 0==Markup.tags[h])m=!1;else if(m){for(var n=Markup.tags[h];""!=M;){var w="";if(f.test(M)){if(-1==(k=M.indexOf("="))){m=!1;break}w=M.substring(0,k).trim().toLowerCase(),M=M.substring(k+1).trim()}else w="unnamed";var b=g(M);if(M=b.str,(void 0==n.attr||void 0==n.attr[w])&&(void 0==Markup.attributes[w]||void 0!=Markup.attributes[w].valid&&!Markup.attributes[w].valid.test(b.value))){m=!1;break}v[w]=b.value}if(m&&n.attr){for(var A in n.attr){if(n.attr[A].req&&void 0==v[A]){m=!1;break}if(void 0!=v[A]&&(void 0!=n.attr[A].valid&&!n.attr[A].valid.test(v[A]))){m=!1;break}}m&&void 0!=n.validate&&(m=n.validate(v))}}}}else m=!1;if(m){if(o!=d){var y=e.substring(o,d).replace(/\\\[/g,"["),S={_rawText:y};r.openTag("<text>",S)}m=c?r.closeTag(h):r.openTag(h,v),o=m?u=p+1:d}m=!0,c=!1,d=p=-1}if(o<s){var y=e.substr(o).replace(/\\\[/g,"["),S={_rawText:y};r.openTag("<text>",S)}return r},createMaps:function(){for(var e=0;e<Markup.maps.length;++e){var a=Markup.maps[e];new Mapper({parent:a[0],zone:a[1],coords:a[2],unique:e})}Markup.maps=[]},toHtml:function(e,a){a||(a={}),a.allow||(a.roles?a.allow=Markup.rolesToClass(a.roles):a.allow=Markup.CLASS_STAFF);var t=Markup._parse(e,a),r=t.toHtml();return a.prepend&&(r=a.prepend+r),a.append&&(r+=a.append),setTimeout(Markup.createMaps,250),r},fromHtml:function(e,a){e=e.replace(/\n+/g,""),e=e.replace(/\s+/g," "),e=e.replace(/> </g,"><"),e=e.replace(/&amp;/gi,"&"),e=e.replace(/(&#160;|$nbsp;)/gi," ");for(var t in Markup.tags)Markup.tags[t].fromHtml&&(e=Markup.tags[t].fromHtml(e,a));return e=e.replace(/<style\b[\s\S]*?>[\s\S]*?<\/style>/g,""),e=e.replace(/<\/?[a-z][a-z0-9]*\b[\s\S]*?>/g," "),e=e.replace(/<!--(.*?)-->/g,""),e=e.replace(/\n[\n]+/g,"\n\n"),e=e.replace(/[ ]+/g," "),e=e.replace(/\t/g,"  "),$WH.trim(e)},removeTags:function(e,a){return Markup._parse(e,a).tagless()},matchOuterTags:function(e,a,t,r){var i,n,l,s,o=r.indexOf("g")>-1,u=r.replace(/g/g,""),d=new RegExp(a+"|"+t,"g"+u),p=new RegExp(a,u),m=[];do{for(i=0;l=d.exec(e);)if(p.test(l[0]))i++||(n=d.lastIndex,s=l);else if(i&&!--i&&(m.push([e.slice(n,l.index),s[0],l[0]]),!o))return m}while(i&&(d.lastIndex=n));return!!m.length&&m},getImageUploadIds:function(e,a){return Markup._parse(e,a).imageUploadIds()},printHtml:function(e,a,t){a=$WH.ge(a);var r=Markup.toHtml(e,t);a.innerHTML=r,Markup.createMaps()},toggleReveal:function(e){var a=$("#reveal-"+e);if(0!=a.length){var t=$("#revealtoggle-"+e);a.is(":visible")?(a.hide(),t.text("(read more)")):(a.show(),t.text("(hide)"))}},mapperPreview:function(e){try{window.mapper=Markup.maps[e];window.open("?edit=mapper-preview","mapperpreview","toolbar=no,location=no,directories=no,status=yes,menubar=no,scrollbars=no,resizable=no,width=800,height=540").focus()}catch(e){}},createTabs:function(e,a,t){for(var r=new Tabs({parent:$WH.ge("dsf67g4d-"+e.id+(t?"-preview":"")),forum:1,noScroll:!!t}),i=0;i<a.length;++i){var n=a[i];r.add(n.name,{id:e.id+"-"+n.id,icon:n.icon,class:n.class})}r.flush()}},MarkupUtil={ltrimText:function(e){return e._rawText=e._rawText.ltrim(),e},rtrimText:function(e){return e._rawText=e._rawText.rtrim(),e},checkSiblingTrim:function(e,a){return"<text>"==a.name&&(Markup.tags[e.name].rtrim||Markup.tags[e.name].trim)?a.attr=MarkupUtil.ltrimText(a.attr):"<text>"==e.name&&(Markup.tags[a.name].ltrim||Markup.tags[a.name].trim)&&(e.attr=MarkupUtil.rtrimText(e.attr)),[e,a]}},MarkupTree=function(){this.nodes=[],this.currentNode=null};MarkupTree.prototype={openTag:function(e,a){if("<text>"!=e&&Markup.tags[e]&&!Markup.tags[e].allowedClass&&(Markup.tags[e].allowedClass=MARKUP_CLASS_PENDING),!Markup.tags[e])return!1;if(Markup.tags[e].allowedModes&&void 0==Markup.tags[e].allowedModes[MarkupModeMap[Markup.mode]])return!1;if(Markup.tags[e].allowedClass&&Markup.tags[e].allowedClass>Markup.allow)return!1;if(Markup.mode==MARKUP_MODE_REPLY&&!Markup.tags[e].allowInReplies)return!1;var t={name:e,attr:a,parent:null,nodes:[]};if(this.currentNode&&(t.parent=this.currentNode),Markup.tags[e].allowedParents)if(null!=t.parent){if(void 0===Markup.tags[e].allowedParents[t.parent.name])return!1}else if(void 0==Markup.root||void 0==Markup.tags[e].allowedParents[Markup.root])return!1;if(t.parent&&Markup.tags[t.parent.name].allowedChildren&&void 0==Markup.tags[t.parent.name].allowedChildren[e])return!1;if(this.currentNode){if(0==this.currentNode.nodes.length&&"<text>"==t.name&&Markup.tags[this.currentNode.name].itrim)t.attr=MarkupUtil.ltrimText(t.attr);else if(this.currentNode.nodes.length>0){var r=this.currentNode.nodes.length-1,i=MarkupUtil.checkSiblingTrim(this.currentNode.nodes[r],t);this.currentNode.nodes[r]=i[0],t=i[1]}"<text>"==t.name?(t.attr._text=Markup._preText(t.attr._rawText),t.attr._text.length>0&&this.currentNode.nodes.push(t)):this.currentNode.nodes.push(t)}else{if(this.nodes.length>0){var r=this.nodes.length-1,i=MarkupUtil.checkSiblingTrim(this.nodes[r],t);this.nodes[r]=i[0],t=i[1]}"<text>"==t.name?(t.attr._text=Markup._preText(t.attr._rawText),t.attr._text.length>0&&this.nodes.push(t)):this.nodes.push(t)}return Markup.tags[e].empty||Markup.tags[e].post||(this.currentNode=t),!0},closeTag:function(e){if(Markup.tags[e].empty||Markup.tags[e].post)return!1;if(!this.currentNode)return!1;if(this.currentNode.name==e){if(this.currentNode.nodes.length>0){var a=this.currentNode.nodes.length-1;if(Markup.tags[this.currentNode.name].itrim&&"<text>"==this.currentNode.nodes[a].name){var t=this.currentNode.nodes[a];t.attr=MarkupUtil.rtrimText(t.attr),t.attr._text=Markup._preText(t.attr._rawText),this.currentNode.nodes[a]=t}}this.currentNode=this.currentNode.parent}else{var r=function(e,a){for(var t=a.length-1;t>=0;--t)if(a[t].name==e)return t;return-1};if(-1==(this.currentNode.parent?r(e,this.currentNode.parent.nodes):r(e,this.nodes)))return!1}return!0},toHtml:function(){var e=[],a={};for(var t in Markup.collectTags)a[t]=[];this.tagless(!0);var r=0;str=function(t,i,n){for(var l="",s=0;s<t.length;++s){var o=t[s];0==i&&0==s&&Markup.firstTags[o.name]?o.attr.first=!0:i>0&&0==s&&Markup.firstTags[o.parent.name]&&(o.attr.first=!0),s==t.length-1&&Markup.firstTags[o.name]&&(o.attr.last=!0),Markup.excludeTags[o.name]&&(n[o.name]=n[o.name]?n[o.name]+1:1);for(var u in n)for(var d in Markup.excludeTags[u])Markup.excludeTags[u][d][o.name]&&(o.attr[d]=!1);if(Markup.collectTags[o.name]&&(o.offset=r++,a[o.name].push(o)),Markup.tags[o.name].post){var p="\x3c!--"+Math.random()+"--\x3e";l+=p,e.push([o,p])}else if(Markup.tags[o.name].empty){var m;m=o.parent&&Markup.tags[o.parent.name].rawText?Markup.tags[o.name].toHtml(o.attr,{needsRaw:!0}):Markup.tags[o.name].toHtml(o.attr),"string"==typeof m?l+=m:void 0!==m&&(""==l&&(l=[]),l.push(m))}else{var c=arguments.callee(o.nodes,i+1,n);o.attr._contents=c,o.attr._nodes=o.nodes;var g=Markup.tags[o.name].toHtml(o.attr);2==g.length?l+=g[0]+c+g[1]:1==g.length&&("string"==typeof g[0]?l+=g[0]:(""==l&&(l=[]),l.push(g[0])))}n[o.name]&&0==--n[o.name]&&delete n[o.name]}return l}(this.nodes,0,[]);for(var i=0;i<e.length;++i){var n=e[i][0],l=e[i][1],s=Markup.tags[n.name].postHtml(n.attr,a);"string"==typeof s&&(str=str.replace(l,s))}return str},tagless:function(e){var a=function(a){for(var t="",r=0;r<a.length;++r){var i=a[r],n=arguments.callee(i.nodes);e?i.attr._textContents=n:i.attr._contents=n,"<text>"==i.name?t+=Markup.tags[i.name].toHtml(i.attr,{noLink:!0,noNbsp:!0}):Markup.tags[i.name].toText&&(t+=Markup.tags[i.name].toText(i.attr)),Markup.tags[i.name].taglessSkip||(t+=n)}return t};if(!e){var t=a(this.nodes);return t=t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')}a(this.nodes)},imageUploadIds:function(){var e=[];return function(a){for(var t=0;t<a.length;++t){var r=a[t];"img"==r.name&&r.attr.upload&&e.push(r.attr.upload),arguments.callee(r.nodes)}}(this.nodes),e}},Markup.tags.modelviewer=Markup.tags.model,Markup.reveals=0,Markup._init(),$(document).ready(function(){$(".quote-header").each(function(e){var a=$(this);if(a.siblings().hasClass("quote-body")){var t=$("<a/>",{href:"javascript:;",class:"toggle"});t.click(function(e){var a=$(e),t=a.parent();t.toggleClass("collapse"),t.hasClass("collapse")?$(this).html("Expand"):$(this).html("Collapse")}.bind(t,this)),$(this).parent().hasClass("collapse")?t.html("Expand"):t.html("Collapse"),a.append(t)}}),$(".quote-wh").each(function(e){var a=$(this),t=$("<a/>",{href:"javascript:;",class:"toggle"});t.click(function(e){var a=$(e);a.toggleClass("collapse"),a.hasClass("collapse")?$(this).html("Expand"):$(this).html("Collapse")}.bind(t,this)),$(this).hasClass("collapse")?t.html("Expand"):t.html("Collapse"),a.append(t)})});